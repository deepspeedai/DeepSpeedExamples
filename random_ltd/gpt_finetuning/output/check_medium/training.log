/opt/conda/lib/python3.8/site-packages/torch/distributed/launch.py:178: FutureWarning: The module torch.distributed.launch is deprecated
and will be removed in future. Use torchrun.
Note that --use_env is set by default in torchrun.
If your script expects `--local_rank` argument to be set, please
change it to read from `os.environ['LOCAL_RANK']` instead. See 
https://pytorch.org/docs/stable/distributed.html#launch-utility for 
further instructions

  warnings.warn(
2022-11-23 22:24:53.081471: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/nvidia/lib64/:/usr/local/cuda/compat/lib.real:/usr/local/cuda/compat/lib:/usr/local/nvidia/lib:/usr/local/nvidia/lib64
2022-11-23 22:24:53.081509: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
Using /home/xiaoxiawu/.cache/torch_extensions/py38_cu113 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/xiaoxiawu/.cache/torch_extensions/py38_cu113/random_ltd/build.ninja...
Building extension module random_ltd...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module random_ltd...
Time to load random_ltd op: 0.20289897918701172 seconds
[2022-11-23 22:24:58,756] [INFO] [comm.py:633:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
11/23/2022 22:24:58 - INFO - torch.distributed.distributed_c10d - Added key: store_based_barrier_key:1 to store for rank: 0
11/23/2022 22:24:58 - INFO - torch.distributed.distributed_c10d - Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 1 nodes.
11/23/2022 22:25:04 - WARNING - datasets.builder - Found cached dataset ptb_text_only (/home/xiaoxiawu/.cache/huggingface/datasets/ptb_text_only/penn_treebank/1.1.0/8d1b97746fb9765d140e569ec5ddd35e20af4d37761f5e1bf357ea0b081f2c1f)
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 791.83it/s]
11/23/2022 22:25:15 - WARNING - datasets.arrow_dataset - Loading cached processed dataset at /home/xiaoxiawu/.cache/huggingface/datasets/ptb_text_only/penn_treebank/1.1.0/8d1b97746fb9765d140e569ec5ddd35e20af4d37761f5e1bf357ea0b081f2c1f/cache-d1717a9b8102bd41.arrow
11/23/2022 22:25:15 - WARNING - datasets.arrow_dataset - Loading cached processed dataset at /home/xiaoxiawu/.cache/huggingface/datasets/ptb_text_only/penn_treebank/1.1.0/8d1b97746fb9765d140e569ec5ddd35e20af4d37761f5e1bf357ea0b081f2c1f/cache-d22336c3065d7300.arrow
11/23/2022 22:25:15 - WARNING - datasets.arrow_dataset - Loading cached processed dataset at /home/xiaoxiawu/.cache/huggingface/datasets/ptb_text_only/penn_treebank/1.1.0/8d1b97746fb9765d140e569ec5ddd35e20af4d37761f5e1bf357ea0b081f2c1f/cache-ad674d78bc878293.arrow
11/23/2022 22:25:15 - WARNING - datasets.arrow_dataset - Loading cached processed dataset at /home/xiaoxiawu/.cache/huggingface/datasets/ptb_text_only/penn_treebank/1.1.0/8d1b97746fb9765d140e569ec5ddd35e20af4d37761f5e1bf357ea0b081f2c1f/cache-8e2a30baf0c6758a.arrow
11/23/2022 22:25:15 - WARNING - datasets.arrow_dataset - Loading cached processed dataset at /home/xiaoxiawu/.cache/huggingface/datasets/ptb_text_only/penn_treebank/1.1.0/8d1b97746fb9765d140e569ec5ddd35e20af4d37761f5e1bf357ea0b081f2c1f/cache-945d548ac10e69dd.arrow
11/23/2022 22:25:15 - WARNING - datasets.arrow_dataset - Loading cached processed dataset at /home/xiaoxiawu/.cache/huggingface/datasets/ptb_text_only/penn_treebank/1.1.0/8d1b97746fb9765d140e569ec5ddd35e20af4d37761f5e1bf357ea0b081f2c1f/cache-f60ee49a5ee4c9ba.arrow
***** Running training *****
  Num examples = 1048
  Num Epochs = 2
  Instantaneous batch size per device = 2
  Gradient Accumulation steps = 1
  Total optimization steps = 1048
Number of parameters: 354823168
what is this lr_scheduler
[2022-11-23 22:25:15,299] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.7.6+39dc1eb4, git-hash=39dc1eb4, git-branch=staging_data_efficiency_v1
[2022-11-23 22:25:15,300] [INFO] [comm.py:629:init_distributed] Distributed backend already initialized
11/23/2022 22:25:15 - INFO - torch.distributed.distributed_c10d - Added key: store_based_barrier_key:2 to store for rank: 0
11/23/2022 22:25:15 - INFO - torch.distributed.distributed_c10d - Rank 0: Completed store-based barrier for key:store_based_barrier_key:2 with 1 nodes.
[2022-11-23 22:25:15,376] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2022-11-23 22:25:15,376] [INFO] [logging.py:68:log_dist] [Rank 0] Removing param_group that has no 'params' in the client Optimizer
[2022-11-23 22:25:15,376] [INFO] [logging.py:68:log_dist] [Rank 0] Using client Optimizer as basic optimizer
[2022-11-23 22:25:15,387] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Basic Optimizer = AdamW
[2022-11-23 22:25:15,387] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Final Optimizer = AdamW
[2022-11-23 22:25:15,387] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed using client LR scheduler
[2022-11-23 22:25:15,387] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed LR Scheduler = <torch.optim.lr_scheduler.LambdaLR object at 0x7f271c4a9940>
[2022-11-23 22:25:15,387] [INFO] [logging.py:68:log_dist] [Rank 0] step=0, skipped=0, lr=[0.0, 0.0], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 22:25:15,387] [INFO] [config.py:995:print] DeepSpeedEngine configuration:
[2022-11-23 22:25:15,388] [INFO] [config.py:999:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2022-11-23 22:25:15,388] [INFO] [config.py:999:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2022-11-23 22:25:15,388] [INFO] [config.py:999:print]   amp_enabled .................. False
[2022-11-23 22:25:15,388] [INFO] [config.py:999:print]   amp_params ................... False
[2022-11-23 22:25:15,388] [INFO] [config.py:999:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "/vc_data/users/xwu/Token-Dropping/random-ltd-version1/DeepSpeedExamples-internal/random_ltd/gpt_finetuning/autotuning_results", 
    "exps_dir": "/vc_data/users/xwu/Token-Dropping/random-ltd-version1/DeepSpeedExamples-internal/random_ltd/gpt_finetuning/autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2022-11-23 22:25:15,388] [INFO] [config.py:999:print]   bfloat16_enabled ............. False
[2022-11-23 22:25:15,388] [INFO] [config.py:999:print]   checkpoint_parallel_write_pipeline  False
[2022-11-23 22:25:15,388] [INFO] [config.py:999:print]   checkpoint_tag_validation_enabled  True
[2022-11-23 22:25:15,388] [INFO] [config.py:999:print]   checkpoint_tag_validation_fail  False
[2022-11-23 22:25:15,388] [INFO] [config.py:999:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f271c4a9850>
[2022-11-23 22:25:15,388] [INFO] [config.py:999:print]   communication_data_type ...... None
[2022-11-23 22:25:15,388] [INFO] [config.py:999:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2022-11-23 22:25:15,388] [INFO] [config.py:999:print]   curriculum_enabled_legacy .... False
[2022-11-23 22:25:15,388] [INFO] [config.py:999:print]   curriculum_params_legacy ..... False
[2022-11-23 22:25:15,389] [INFO] [config.py:999:print]   data_efficiency_config ....... {'enabled': True, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': True, 'random_ltd': {'enabled': True, 'layer_token_lr_schedule': {'enabled': False}, 'total_layer_num': 24, 'random_ltd_layer_num': 22, 'random_ltd_layer_id': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22], 'model_mask_name': 'attention_mask', 'model_type': 'decoder', 'hidden_state_order': 'batch_seq_dim', 'random_ltd_schedule': {'min_value': 128, 'max_value': 1024, 'schedule_type': 'fixed_linear', 'schedule_config': {'require_steps': 400, 'seq_per_step': 8}}, 'global_batch_size': 4, 'micro_batch_size': 2}}}
[2022-11-23 22:25:15,389] [INFO] [config.py:999:print]   data_efficiency_enabled ...... True
[2022-11-23 22:25:15,389] [INFO] [config.py:999:print]   dataloader_drop_last ......... False
[2022-11-23 22:25:15,389] [INFO] [config.py:999:print]   disable_allgather ............ False
[2022-11-23 22:25:15,389] [INFO] [config.py:999:print]   dump_state ................... False
[2022-11-23 22:25:15,389] [INFO] [config.py:999:print]   dynamic_loss_scale_args ...... None
[2022-11-23 22:25:15,389] [INFO] [config.py:999:print]   eigenvalue_enabled ........... False
[2022-11-23 22:25:15,389] [INFO] [config.py:999:print]   eigenvalue_gas_boundary_resolution  1
[2022-11-23 22:25:15,389] [INFO] [config.py:999:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2022-11-23 22:25:15,389] [INFO] [config.py:999:print]   eigenvalue_layer_num ......... 0
[2022-11-23 22:25:15,389] [INFO] [config.py:999:print]   eigenvalue_max_iter .......... 100
[2022-11-23 22:25:15,389] [INFO] [config.py:999:print]   eigenvalue_stability ......... 1e-06
[2022-11-23 22:25:15,389] [INFO] [config.py:999:print]   eigenvalue_tol ............... 0.01
[2022-11-23 22:25:15,389] [INFO] [config.py:999:print]   eigenvalue_verbose ........... False
[2022-11-23 22:25:15,389] [INFO] [config.py:999:print]   elasticity_enabled ........... False
[2022-11-23 22:25:15,389] [INFO] [config.py:999:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2022-11-23 22:25:15,389] [INFO] [config.py:999:print]   fp16_auto_cast ............... None
[2022-11-23 22:25:15,389] [INFO] [config.py:999:print]   fp16_enabled ................. False
[2022-11-23 22:25:15,389] [INFO] [config.py:999:print]   fp16_master_weights_and_gradients  False
[2022-11-23 22:25:15,389] [INFO] [config.py:999:print]   global_rank .................. 0
[2022-11-23 22:25:15,389] [INFO] [config.py:999:print]   gradient_accumulation_steps .. 2
[2022-11-23 22:25:15,389] [INFO] [config.py:999:print]   gradient_clipping ............ 1.0
[2022-11-23 22:25:15,389] [INFO] [config.py:999:print]   gradient_predivide_factor .... 1.0
[2022-11-23 22:25:15,389] [INFO] [config.py:999:print]   initial_dynamic_scale ........ 4294967296
[2022-11-23 22:25:15,389] [INFO] [config.py:999:print]   load_universal_checkpoint .... False
[2022-11-23 22:25:15,389] [INFO] [config.py:999:print]   loss_scale ................... 0
[2022-11-23 22:25:15,389] [INFO] [config.py:999:print]   memory_breakdown ............. False
[2022-11-23 22:25:15,389] [INFO] [config.py:999:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7f271c4a9670>
[2022-11-23 22:25:15,389] [INFO] [config.py:999:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2022-11-23 22:25:15,389] [INFO] [config.py:999:print]   optimizer_legacy_fusion ...... False
[2022-11-23 22:25:15,389] [INFO] [config.py:999:print]   optimizer_name ............... adam
[2022-11-23 22:25:15,389] [INFO] [config.py:999:print]   optimizer_params ............. {'lr': 0.0001, 'betas': [0.8, 0.999], 'eps': 1e-08, 'weight_decay': 3e-07}
[2022-11-23 22:25:15,389] [INFO] [config.py:999:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2022-11-23 22:25:15,389] [INFO] [config.py:999:print]   pld_enabled .................. False
[2022-11-23 22:25:15,389] [INFO] [config.py:999:print]   pld_params ................... False
[2022-11-23 22:25:15,389] [INFO] [config.py:999:print]   prescale_gradients ........... True
[2022-11-23 22:25:15,389] [INFO] [config.py:999:print]   scheduler_name ............... None
[2022-11-23 22:25:15,389] [INFO] [config.py:999:print]   scheduler_params ............. None
[2022-11-23 22:25:15,389] [INFO] [config.py:999:print]   sparse_attention ............. None
[2022-11-23 22:25:15,389] [INFO] [config.py:999:print]   sparse_gradients_enabled ..... False
[2022-11-23 22:25:15,389] [INFO] [config.py:999:print]   steps_per_print .............. 2
[2022-11-23 22:25:15,389] [INFO] [config.py:999:print]   train_batch_size ............. 4
[2022-11-23 22:25:15,389] [INFO] [config.py:999:print]   train_micro_batch_size_per_gpu  2
[2022-11-23 22:25:15,389] [INFO] [config.py:999:print]   use_node_local_storage ....... False
[2022-11-23 22:25:15,390] [INFO] [config.py:999:print]   wall_clock_breakdown ......... False
[2022-11-23 22:25:15,390] [INFO] [config.py:999:print]   world_size ................... 1
[2022-11-23 22:25:15,390] [INFO] [config.py:999:print]   zero_allow_untested_optimizer  False
[2022-11-23 22:25:15,390] [INFO] [config.py:999:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2022-11-23 22:25:15,390] [INFO] [config.py:999:print]   zero_enabled ................. False
[2022-11-23 22:25:15,390] [INFO] [config.py:999:print]   zero_optimization_stage ...... 0
[2022-11-23 22:25:15,390] [INFO] [config.py:984:print_user_config]   json = {
    "train_batch_size": 4, 
    "train_micro_batch_size_per_gpu": 2, 
    "steps_per_print": 2, 
    "optimizer": {
        "type": "Adam", 
        "params": {
            "lr": 0.0001, 
            "betas": [0.8, 0.999], 
            "eps": 1e-08, 
            "weight_decay": 3e-07
        }
    }, 
    "zero_optimization": {
        "stage": 0
    }, 
    "fp16": {
        "enabled": false
    }, 
    "gradient_clipping": 1.0, 
    "prescale_gradients": true, 
    "wall_clock_breakdown": false, 
    "data_efficiency": {
        "enabled": true, 
        "data_routing": {
            "enabled": true, 
            "random_ltd": {
                "enabled": true, 
                "total_layer_num": 24, 
                "random_ltd_layer_num": 22, 
                "random_ltd_layer_id": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22], 
                "model_mask_name": "attention_mask", 
                "model_type": "decoder", 
                "hidden_state_order": "batch_seq_dim", 
                "random_ltd_schedule": {
                    "min_value": 128, 
                    "max_value": 1.024000e+03, 
                    "schedule_type": "fixed_linear", 
                    "schedule_config": {
                        "require_steps": 400, 
                        "seq_per_step": 8
                    }
                }
            }
        }, 
        "data_sampling": {
            "curriculum_learning": {
            }
        }
    }
}
Using /home/xiaoxiawu/.cache/torch_extensions/py38_cu113 as PyTorch extensions root...
Emitting ninja build file /home/xiaoxiawu/.cache/torch_extensions/py38_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 1.079115390777588 seconds
*************************initialization with 44.842962395942756***********************************
***** Evaluating perplexity, Epoch 1/2 *****
'step':0, 'ppl': 44.842962395942756, 'seq_len': 128, 'consume layer-tokens': 19456
[2022-11-23 22:25:55,201] [INFO] [logging.py:68:log_dist] [Rank 0] step=2, skipped=0, lr=[1.0000000000000002e-06, 1.0000000000000002e-06], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 22:25:55,201] [INFO] [timer.py:198:stop] 0/4, RunningAvgSamplesPerSec=10.734443511014227, CurrSamplesPerSec=9.222730161243152, MemAllocated=4.49GB, MaxMemAllocated=8.99GB
[2022-11-23 22:26:10,805] [INFO] [timer.py:198:stop] 0/6, RunningAvgSamplesPerSec=10.789803165962876, CurrSamplesPerSec=9.18681347564488, MemAllocated=4.49GB, MaxMemAllocated=9.0GB
[2022-11-23 22:26:26,354] [INFO] [logging.py:68:log_dist] [Rank 0] step=4, skipped=0, lr=[2.0000000000000003e-06, 2.0000000000000003e-06], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 22:26:26,354] [INFO] [timer.py:198:stop] 0/8, RunningAvgSamplesPerSec=10.82500901696092, CurrSamplesPerSec=9.288382944186267, MemAllocated=4.49GB, MaxMemAllocated=9.0GB
[2022-11-23 22:26:41,886] [INFO] [timer.py:198:stop] 0/10, RunningAvgSamplesPerSec=10.79562305762766, CurrSamplesPerSec=9.056497522815041, MemAllocated=4.49GB, MaxMemAllocated=9.08GB
***** Evaluating perplexity, Epoch 1/2 *****
'step':10, 'ppl': 44.84108456803058, 'seq_len': 136, 'consume layer-tokens': 118144
[2022-11-23 22:27:04,949] [INFO] [logging.py:68:log_dist] [Rank 0] step=6, skipped=0, lr=[3e-06, 3e-06], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 22:27:04,950] [INFO] [timer.py:198:stop] 0/12, RunningAvgSamplesPerSec=10.793679387136379, CurrSamplesPerSec=9.156279641415955, MemAllocated=4.49GB, MaxMemAllocated=9.08GB
[2022-11-23 22:27:20,471] [INFO] [timer.py:198:stop] 0/14, RunningAvgSamplesPerSec=10.805601296028572, CurrSamplesPerSec=9.22622971734896, MemAllocated=4.49GB, MaxMemAllocated=9.08GB
[2022-11-23 22:27:35,993] [INFO] [logging.py:68:log_dist] [Rank 0] step=8, skipped=0, lr=[4.000000000000001e-06, 4.000000000000001e-06], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 22:27:35,994] [INFO] [timer.py:198:stop] 0/16, RunningAvgSamplesPerSec=10.816121033929722, CurrSamplesPerSec=9.23431419711432, MemAllocated=4.49GB, MaxMemAllocated=9.08GB
[2022-11-23 22:27:51,519] [INFO] [timer.py:198:stop] 0/18, RunningAvgSamplesPerSec=10.802234237964, CurrSamplesPerSec=9.148590566990466, MemAllocated=4.5GB, MaxMemAllocated=9.14GB
[2022-11-23 22:28:07,052] [INFO] [logging.py:68:log_dist] [Rank 0] step=10, skipped=0, lr=[5e-06, 5e-06], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 22:28:07,053] [INFO] [timer.py:198:stop] 0/20, RunningAvgSamplesPerSec=10.7852013796663, CurrSamplesPerSec=9.017313104254857, MemAllocated=4.5GB, MaxMemAllocated=9.14GB
***** Evaluating perplexity, Epoch 1/2 *****
'step':20, 'ppl': 44.84179170343056, 'seq_len': 144, 'consume layer-tokens': 221056
[2022-11-23 22:28:30,176] [INFO] [timer.py:198:stop] 0/22, RunningAvgSamplesPerSec=10.785919326579508, CurrSamplesPerSec=9.179957014475878, MemAllocated=4.5GB, MaxMemAllocated=9.14GB
[2022-11-23 22:28:45,704] [INFO] [logging.py:68:log_dist] [Rank 0] step=12, skipped=0, lr=[6e-06, 6e-06], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 22:28:45,705] [INFO] [timer.py:198:stop] 0/24, RunningAvgSamplesPerSec=10.779490080207154, CurrSamplesPerSec=9.122940880276062, MemAllocated=4.5GB, MaxMemAllocated=9.19GB
[2022-11-23 22:29:01,246] [INFO] [timer.py:198:stop] 0/26, RunningAvgSamplesPerSec=10.76552400884036, CurrSamplesPerSec=9.006518193716294, MemAllocated=4.5GB, MaxMemAllocated=9.19GB
[2022-11-23 22:29:16,797] [INFO] [logging.py:68:log_dist] [Rank 0] step=14, skipped=0, lr=[7.000000000000001e-06, 7.000000000000001e-06], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 22:29:16,798] [INFO] [timer.py:198:stop] 0/28, RunningAvgSamplesPerSec=10.759361245487042, CurrSamplesPerSec=9.119648112332701, MemAllocated=4.5GB, MaxMemAllocated=9.19GB
[2022-11-23 22:29:32,352] [INFO] [timer.py:198:stop] 0/30, RunningAvgSamplesPerSec=10.753045179714887, CurrSamplesPerSec=9.084921833964184, MemAllocated=4.5GB, MaxMemAllocated=9.19GB
***** Evaluating perplexity, Epoch 1/2 *****
'step':30, 'ppl': 44.87321371615159, 'seq_len': 160, 'consume layer-tokens': 329600
[2022-11-23 22:29:55,694] [INFO] [logging.py:68:log_dist] [Rank 0] step=16, skipped=0, lr=[8.000000000000001e-06, 8.000000000000001e-06], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 22:29:55,694] [INFO] [timer.py:198:stop] 0/32, RunningAvgSamplesPerSec=10.361951517536653, CurrSamplesPerSec=4.6782215792705335, MemAllocated=4.5GB, MaxMemAllocated=9.26GB
[2022-11-23 22:30:11,250] [INFO] [timer.py:198:stop] 0/34, RunningAvgSamplesPerSec=10.373063552860684, CurrSamplesPerSec=8.97407676836835, MemAllocated=4.5GB, MaxMemAllocated=9.26GB
[2022-11-23 22:30:26,804] [INFO] [logging.py:68:log_dist] [Rank 0] step=18, skipped=0, lr=[9e-06, 9e-06], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 22:30:26,805] [INFO] [timer.py:198:stop] 0/36, RunningAvgSamplesPerSec=10.380058943886846, CurrSamplesPerSec=9.0755647203797, MemAllocated=4.5GB, MaxMemAllocated=9.26GB
[2022-11-23 22:30:42,394] [INFO] [timer.py:198:stop] 0/38, RunningAvgSamplesPerSec=10.369714612121058, CurrSamplesPerSec=8.744409268735582, MemAllocated=4.51GB, MaxMemAllocated=9.3GB
[2022-11-23 22:30:57,948] [INFO] [logging.py:68:log_dist] [Rank 0] step=20, skipped=0, lr=[1e-05, 1e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 22:30:57,949] [INFO] [timer.py:198:stop] 0/40, RunningAvgSamplesPerSec=10.36297679204616, CurrSamplesPerSec=8.773033557454081, MemAllocated=4.51GB, MaxMemAllocated=9.3GB
***** Evaluating perplexity, Epoch 1/2 *****
'step':40, 'ppl': 44.984397941610155, 'seq_len': 168, 'consume layer-tokens': 443072
[2022-11-23 22:31:21,110] [INFO] [timer.py:198:stop] 0/42, RunningAvgSamplesPerSec=10.35610512376164, CurrSamplesPerSec=8.792564804828222, MemAllocated=4.51GB, MaxMemAllocated=9.3GB
[2022-11-23 22:31:36,683] [INFO] [logging.py:68:log_dist] [Rank 0] step=22, skipped=0, lr=[1.1000000000000001e-05, 1.1000000000000001e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 22:31:36,684] [INFO] [timer.py:198:stop] 0/44, RunningAvgSamplesPerSec=10.349479532019444, CurrSamplesPerSec=8.74995488696708, MemAllocated=4.51GB, MaxMemAllocated=9.3GB
[2022-11-23 22:31:52,259] [INFO] [timer.py:198:stop] 0/46, RunningAvgSamplesPerSec=10.338088048317546, CurrSamplesPerSec=8.675076371954688, MemAllocated=4.51GB, MaxMemAllocated=9.37GB
[2022-11-23 22:32:07,822] [INFO] [logging.py:68:log_dist] [Rank 0] step=24, skipped=0, lr=[1.2e-05, 1.2e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 22:32:07,822] [INFO] [timer.py:198:stop] 0/48, RunningAvgSamplesPerSec=10.329688511718008, CurrSamplesPerSec=8.743907955879195, MemAllocated=4.51GB, MaxMemAllocated=9.37GB
[2022-11-23 22:32:23,388] [INFO] [timer.py:198:stop] 0/50, RunningAvgSamplesPerSec=10.319427490429906, CurrSamplesPerSec=8.706237668873513, MemAllocated=4.51GB, MaxMemAllocated=9.37GB
***** Evaluating perplexity, Epoch 1/2 *****
'step':50, 'ppl': 45.249469534308965, 'seq_len': 184, 'consume layer-tokens': 561472
[2022-11-23 22:32:46,542] [INFO] [logging.py:68:log_dist] [Rank 0] step=26, skipped=0, lr=[1.3000000000000001e-05, 1.3000000000000001e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 22:32:46,543] [INFO] [timer.py:198:stop] 0/52, RunningAvgSamplesPerSec=10.305331170271534, CurrSamplesPerSec=8.540744277820822, MemAllocated=4.52GB, MaxMemAllocated=9.44GB
[2022-11-23 22:33:02,133] [INFO] [timer.py:198:stop] 0/54, RunningAvgSamplesPerSec=10.291895813857444, CurrSamplesPerSec=8.582784926169662, MemAllocated=4.51GB, MaxMemAllocated=9.44GB
[2022-11-23 22:33:17,714] [INFO] [logging.py:68:log_dist] [Rank 0] step=28, skipped=0, lr=[1.4000000000000001e-05, 1.4000000000000001e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 22:33:17,715] [INFO] [timer.py:198:stop] 0/56, RunningAvgSamplesPerSec=10.278347468652088, CurrSamplesPerSec=8.559175244267768, MemAllocated=4.51GB, MaxMemAllocated=9.44GB
[2022-11-23 22:33:33,284] [INFO] [timer.py:198:stop] 0/58, RunningAvgSamplesPerSec=10.268398405038942, CurrSamplesPerSec=8.585358664514683, MemAllocated=4.51GB, MaxMemAllocated=9.44GB
[2022-11-23 22:33:48,864] [INFO] [logging.py:68:log_dist] [Rank 0] step=30, skipped=0, lr=[1.5e-05, 1.5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 22:33:48,865] [INFO] [timer.py:198:stop] 0/60, RunningAvgSamplesPerSec=10.254579564868703, CurrSamplesPerSec=8.49156826521574, MemAllocated=4.52GB, MaxMemAllocated=9.5GB
***** Evaluating perplexity, Epoch 1/2 *****
'step':60, 'ppl': 45.75721254018751, 'seq_len': 192, 'consume layer-tokens': 684800
[2022-11-23 22:34:12,042] [INFO] [timer.py:198:stop] 0/62, RunningAvgSamplesPerSec=10.239632513188614, CurrSamplesPerSec=8.486190706939093, MemAllocated=4.52GB, MaxMemAllocated=9.5GB
[2022-11-23 22:34:27,618] [INFO] [logging.py:68:log_dist] [Rank 0] step=32, skipped=0, lr=[1.6000000000000003e-05, 1.6000000000000003e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 22:34:27,619] [INFO] [timer.py:198:stop] 0/64, RunningAvgSamplesPerSec=10.228356198670399, CurrSamplesPerSec=8.506965409745794, MemAllocated=4.52GB, MaxMemAllocated=9.5GB
[2022-11-23 22:34:43,229] [INFO] [timer.py:198:stop] 0/66, RunningAvgSamplesPerSec=10.21729673666906, CurrSamplesPerSec=8.514814581730407, MemAllocated=4.52GB, MaxMemAllocated=9.5GB
[2022-11-23 22:34:58,811] [INFO] [logging.py:68:log_dist] [Rank 0] step=34, skipped=0, lr=[1.7000000000000003e-05, 1.7000000000000003e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 22:34:58,812] [INFO] [timer.py:198:stop] 0/68, RunningAvgSamplesPerSec=10.202512928064033, CurrSamplesPerSec=8.39968718740018, MemAllocated=4.52GB, MaxMemAllocated=9.58GB
[2022-11-23 22:35:14,393] [INFO] [timer.py:198:stop] 0/70, RunningAvgSamplesPerSec=10.1884003000372, CurrSamplesPerSec=8.418231757554835, MemAllocated=4.52GB, MaxMemAllocated=9.58GB
***** Evaluating perplexity, Epoch 1/2 *****
'step':70, 'ppl': 46.67331270219406, 'seq_len': 200, 'consume layer-tokens': 812352
[2022-11-23 22:35:37,556] [INFO] [logging.py:68:log_dist] [Rank 0] step=36, skipped=0, lr=[1.8e-05, 1.8e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 22:35:37,557] [INFO] [timer.py:198:stop] 0/72, RunningAvgSamplesPerSec=10.174097418810511, CurrSamplesPerSec=8.329667274366582, MemAllocated=4.52GB, MaxMemAllocated=9.58GB
[2022-11-23 22:35:53,141] [INFO] [timer.py:198:stop] 0/74, RunningAvgSamplesPerSec=10.159045963670001, CurrSamplesPerSec=8.339654229671826, MemAllocated=4.53GB, MaxMemAllocated=9.63GB
[2022-11-23 22:36:08,738] [INFO] [logging.py:68:log_dist] [Rank 0] step=38, skipped=0, lr=[1.9e-05, 1.9e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 22:36:08,739] [INFO] [timer.py:198:stop] 0/76, RunningAvgSamplesPerSec=10.145315929751305, CurrSamplesPerSec=8.342864076269812, MemAllocated=4.53GB, MaxMemAllocated=9.63GB
[2022-11-23 22:36:24,332] [INFO] [timer.py:198:stop] 0/78, RunningAvgSamplesPerSec=10.130200299621741, CurrSamplesPerSec=8.320587199642919, MemAllocated=4.53GB, MaxMemAllocated=9.63GB
[2022-11-23 22:36:39,920] [INFO] [logging.py:68:log_dist] [Rank 0] step=40, skipped=0, lr=[2e-05, 2e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 22:36:39,921] [INFO] [timer.py:198:stop] 0/80, RunningAvgSamplesPerSec=10.117644111749911, CurrSamplesPerSec=8.309625014239652, MemAllocated=4.53GB, MaxMemAllocated=9.63GB
***** Evaluating perplexity, Epoch 1/2 *****
'step':80, 'ppl': 48.290748473349375, 'seq_len': 216, 'consume layer-tokens': 945536
[2022-11-23 22:37:03,106] [INFO] [timer.py:198:stop] 0/82, RunningAvgSamplesPerSec=10.101549156210586, CurrSamplesPerSec=8.20661000981239, MemAllocated=4.53GB, MaxMemAllocated=9.69GB
[2022-11-23 22:37:18,703] [INFO] [logging.py:68:log_dist] [Rank 0] step=42, skipped=0, lr=[2.1e-05, 2.1e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 22:37:18,704] [INFO] [timer.py:198:stop] 0/84, RunningAvgSamplesPerSec=10.086154847566867, CurrSamplesPerSec=8.218694705655283, MemAllocated=4.53GB, MaxMemAllocated=9.69GB
[2022-11-23 22:37:34,298] [INFO] [timer.py:198:stop] 0/86, RunningAvgSamplesPerSec=10.072398075949359, CurrSamplesPerSec=8.221892682085356, MemAllocated=4.53GB, MaxMemAllocated=9.69GB
[2022-11-23 22:37:49,886] [INFO] [logging.py:68:log_dist] [Rank 0] step=44, skipped=0, lr=[2.2000000000000003e-05, 2.2000000000000003e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 22:37:49,886] [INFO] [timer.py:198:stop] 0/88, RunningAvgSamplesPerSec=10.057181821303292, CurrSamplesPerSec=8.19685087073014, MemAllocated=4.53GB, MaxMemAllocated=9.75GB
[2022-11-23 22:38:05,488] [INFO] [timer.py:198:stop] 0/90, RunningAvgSamplesPerSec=10.041804683000972, CurrSamplesPerSec=8.146604953258503, MemAllocated=4.53GB, MaxMemAllocated=9.75GB
***** Evaluating perplexity, Epoch 1/2 *****
'step':90, 'ppl': 50.68065151533971, 'seq_len': 224, 'consume layer-tokens': 1083648
[2022-11-23 22:38:28,672] [INFO] [logging.py:68:log_dist] [Rank 0] step=46, skipped=0, lr=[2.3000000000000003e-05, 2.3000000000000003e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 22:38:28,672] [INFO] [timer.py:198:stop] 0/92, RunningAvgSamplesPerSec=10.027580621857792, CurrSamplesPerSec=8.136482807251692, MemAllocated=4.54GB, MaxMemAllocated=9.75GB
[2022-11-23 22:38:44,272] [INFO] [timer.py:198:stop] 0/94, RunningAvgSamplesPerSec=10.01388622476139, CurrSamplesPerSec=8.174381971668485, MemAllocated=4.53GB, MaxMemAllocated=9.75GB
[2022-11-23 22:38:59,872] [INFO] [logging.py:68:log_dist] [Rank 0] step=48, skipped=0, lr=[2.4e-05, 2.4e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 22:38:59,873] [INFO] [timer.py:198:stop] 0/96, RunningAvgSamplesPerSec=9.993971798244365, CurrSamplesPerSec=7.924808577974067, MemAllocated=4.54GB, MaxMemAllocated=9.82GB
[2022-11-23 22:39:15,479] [INFO] [timer.py:198:stop] 0/98, RunningAvgSamplesPerSec=9.976738117576485, CurrSamplesPerSec=7.984884266596609, MemAllocated=4.54GB, MaxMemAllocated=9.82GB
[2022-11-23 22:39:31,091] [INFO] [logging.py:68:log_dist] [Rank 0] step=50, skipped=0, lr=[2.5e-05, 2.5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 22:39:31,092] [INFO] [timer.py:198:stop] 0/100, RunningAvgSamplesPerSec=9.959325428734745, CurrSamplesPerSec=7.97785231771767, MemAllocated=4.54GB, MaxMemAllocated=9.82GB
***** Evaluating perplexity, Epoch 1/2 *****
'step':100, 'ppl': 53.764878638092284, 'seq_len': 240, 'consume layer-tokens': 1226688
[2022-11-23 22:39:54,297] [INFO] [timer.py:198:stop] 0/102, RunningAvgSamplesPerSec=9.941179809031073, CurrSamplesPerSec=7.945864433751374, MemAllocated=4.54GB, MaxMemAllocated=9.89GB
[2022-11-23 22:40:09,905] [INFO] [logging.py:68:log_dist] [Rank 0] step=52, skipped=0, lr=[2.6000000000000002e-05, 2.6000000000000002e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 22:40:09,906] [INFO] [timer.py:198:stop] 0/104, RunningAvgSamplesPerSec=9.923913847414308, CurrSamplesPerSec=7.912385267881987, MemAllocated=4.54GB, MaxMemAllocated=9.89GB
[2022-11-23 22:40:25,522] [INFO] [timer.py:198:stop] 0/106, RunningAvgSamplesPerSec=9.907367976604757, CurrSamplesPerSec=7.9467451305083445, MemAllocated=4.54GB, MaxMemAllocated=9.89GB
[2022-11-23 22:40:41,143] [INFO] [logging.py:68:log_dist] [Rank 0] step=54, skipped=0, lr=[2.7000000000000002e-05, 2.7000000000000002e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 22:40:41,144] [INFO] [timer.py:198:stop] 0/108, RunningAvgSamplesPerSec=9.891373046480338, CurrSamplesPerSec=7.939028741403085, MemAllocated=4.54GB, MaxMemAllocated=9.89GB
[2022-11-23 22:40:56,778] [INFO] [timer.py:198:stop] 0/110, RunningAvgSamplesPerSec=9.869367832424375, CurrSamplesPerSec=7.694869358146907, MemAllocated=4.55GB, MaxMemAllocated=9.96GB
***** Evaluating perplexity, Epoch 1/2 *****
'step':110, 'ppl': 57.11404925199742, 'seq_len': 248, 'consume layer-tokens': 1374656
[2022-11-23 22:41:19,984] [INFO] [logging.py:68:log_dist] [Rank 0] step=56, skipped=0, lr=[2.8000000000000003e-05, 2.8000000000000003e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 22:41:19,985] [INFO] [timer.py:198:stop] 0/112, RunningAvgSamplesPerSec=9.849283097318878, CurrSamplesPerSec=7.737490441829597, MemAllocated=4.55GB, MaxMemAllocated=9.96GB
[2022-11-23 22:41:35,614] [INFO] [timer.py:198:stop] 0/114, RunningAvgSamplesPerSec=9.830106591614777, CurrSamplesPerSec=7.733367504694721, MemAllocated=4.55GB, MaxMemAllocated=9.96GB
[2022-11-23 22:41:51,256] [INFO] [logging.py:68:log_dist] [Rank 0] step=58, skipped=0, lr=[2.9e-05, 2.9e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 22:41:51,257] [INFO] [timer.py:198:stop] 0/116, RunningAvgSamplesPerSec=9.806752399695073, CurrSamplesPerSec=7.4212548513777605, MemAllocated=4.55GB, MaxMemAllocated=9.96GB
[2022-11-23 22:42:06,886] [INFO] [timer.py:198:stop] 0/118, RunningAvgSamplesPerSec=9.786453268533803, CurrSamplesPerSec=7.537909666659478, MemAllocated=4.55GB, MaxMemAllocated=10.04GB
[2022-11-23 22:42:22,533] [INFO] [logging.py:68:log_dist] [Rank 0] step=60, skipped=0, lr=[3e-05, 3e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 22:42:22,534] [INFO] [timer.py:198:stop] 0/120, RunningAvgSamplesPerSec=9.769754366201608, CurrSamplesPerSec=7.765439264465877, MemAllocated=4.55GB, MaxMemAllocated=10.04GB
***** Evaluating perplexity, Epoch 1/2 *****
'step':120, 'ppl': 60.19887755459786, 'seq_len': 256, 'consume layer-tokens': 1526848
[2022-11-23 22:42:45,801] [INFO] [timer.py:198:stop] 0/122, RunningAvgSamplesPerSec=9.754120586149384, CurrSamplesPerSec=7.780651253041126, MemAllocated=4.55GB, MaxMemAllocated=10.04GB
[2022-11-23 22:43:01,439] [INFO] [logging.py:68:log_dist] [Rank 0] step=62, skipped=0, lr=[3.1e-05, 3.1e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 22:43:01,440] [INFO] [timer.py:198:stop] 0/124, RunningAvgSamplesPerSec=9.734185067008791, CurrSamplesPerSec=7.599347380417245, MemAllocated=4.55GB, MaxMemAllocated=10.11GB
[2022-11-23 22:43:17,057] [INFO] [timer.py:198:stop] 0/126, RunningAvgSamplesPerSec=9.715218591518692, CurrSamplesPerSec=7.61102048148827, MemAllocated=4.55GB, MaxMemAllocated=10.12GB
[2022-11-23 22:43:32,670] [INFO] [logging.py:68:log_dist] [Rank 0] step=64, skipped=0, lr=[3.2000000000000005e-05, 3.2000000000000005e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 22:43:32,671] [INFO] [timer.py:198:stop] 0/128, RunningAvgSamplesPerSec=9.696955302704357, CurrSamplesPerSec=7.61812597512755, MemAllocated=4.55GB, MaxMemAllocated=10.12GB
[2022-11-23 22:43:48,291] [INFO] [timer.py:198:stop] 0/130, RunningAvgSamplesPerSec=9.679288227095075, CurrSamplesPerSec=7.608625023015602, MemAllocated=4.55GB, MaxMemAllocated=10.12GB
***** Evaluating perplexity, Epoch 1/2 *****
'step':130, 'ppl': 63.12520197056146, 'seq_len': 272, 'consume layer-tokens': 1684672
[2022-11-23 22:44:11,482] [INFO] [logging.py:68:log_dist] [Rank 0] step=66, skipped=0, lr=[3.3e-05, 3.3e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 22:44:11,483] [INFO] [timer.py:198:stop] 0/132, RunningAvgSamplesPerSec=9.662058460608536, CurrSamplesPerSec=7.610868563257811, MemAllocated=4.56GB, MaxMemAllocated=10.19GB
[2022-11-23 22:44:27,119] [INFO] [timer.py:198:stop] 0/134, RunningAvgSamplesPerSec=9.644819930263353, CurrSamplesPerSec=7.565517521273094, MemAllocated=4.56GB, MaxMemAllocated=10.19GB
[2022-11-23 22:44:42,770] [INFO] [logging.py:68:log_dist] [Rank 0] step=68, skipped=0, lr=[3.4000000000000007e-05, 3.4000000000000007e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 22:44:42,770] [INFO] [timer.py:198:stop] 0/136, RunningAvgSamplesPerSec=9.62789712239937, CurrSamplesPerSec=7.581613479616175, MemAllocated=4.56GB, MaxMemAllocated=10.19GB
[2022-11-23 22:44:58,412] [INFO] [timer.py:198:stop] 0/138, RunningAvgSamplesPerSec=9.611922541153366, CurrSamplesPerSec=7.591232526634807, MemAllocated=4.56GB, MaxMemAllocated=10.26GB
[2022-11-23 22:45:14,056] [INFO] [logging.py:68:log_dist] [Rank 0] step=70, skipped=0, lr=[3.5e-05, 3.5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 22:45:14,057] [INFO] [timer.py:198:stop] 0/140, RunningAvgSamplesPerSec=9.596198882727967, CurrSamplesPerSec=7.581476437036642, MemAllocated=4.56GB, MaxMemAllocated=10.26GB
***** Evaluating perplexity, Epoch 1/2 *****
'step':140, 'ppl': 65.51647964504824, 'seq_len': 280, 'consume layer-tokens': 1847424
[2022-11-23 22:45:37,290] [INFO] [timer.py:198:stop] 0/142, RunningAvgSamplesPerSec=9.580574803592954, CurrSamplesPerSec=7.5543576244582065, MemAllocated=4.56GB, MaxMemAllocated=10.26GB
[2022-11-23 22:45:52,931] [INFO] [logging.py:68:log_dist] [Rank 0] step=72, skipped=0, lr=[3.6e-05, 3.6e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 22:45:52,932] [INFO] [timer.py:198:stop] 0/144, RunningAvgSamplesPerSec=9.565753836466628, CurrSamplesPerSec=7.558530212106468, MemAllocated=4.56GB, MaxMemAllocated=10.26GB
[2022-11-23 22:46:08,565] [INFO] [timer.py:198:stop] 0/146, RunningAvgSamplesPerSec=9.550352317415639, CurrSamplesPerSec=7.522376281661546, MemAllocated=4.57GB, MaxMemAllocated=10.33GB
[2022-11-23 22:46:24,222] [INFO] [logging.py:68:log_dist] [Rank 0] step=74, skipped=0, lr=[3.7e-05, 3.7e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 22:46:24,223] [INFO] [timer.py:198:stop] 0/148, RunningAvgSamplesPerSec=9.53555946056841, CurrSamplesPerSec=7.525635815411005, MemAllocated=4.57GB, MaxMemAllocated=10.34GB
[2022-11-23 22:46:39,873] [INFO] [timer.py:198:stop] 0/150, RunningAvgSamplesPerSec=9.521410258436692, CurrSamplesPerSec=7.536792207873885, MemAllocated=4.57GB, MaxMemAllocated=10.34GB
***** Evaluating perplexity, Epoch 1/2 *****
'step':150, 'ppl': 66.54695271279213, 'seq_len': 296, 'consume layer-tokens': 2015104
[2022-11-23 22:47:03,095] [INFO] [logging.py:68:log_dist] [Rank 0] step=76, skipped=0, lr=[3.8e-05, 3.8e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 22:47:03,096] [INFO] [timer.py:198:stop] 0/152, RunningAvgSamplesPerSec=9.506678293660574, CurrSamplesPerSec=7.494231432395104, MemAllocated=4.57GB, MaxMemAllocated=10.4GB
[2022-11-23 22:47:18,733] [INFO] [timer.py:198:stop] 0/154, RunningAvgSamplesPerSec=9.492414144120378, CurrSamplesPerSec=7.505523156457521, MemAllocated=4.57GB, MaxMemAllocated=10.4GB
[2022-11-23 22:47:34,381] [INFO] [logging.py:68:log_dist] [Rank 0] step=78, skipped=0, lr=[3.9000000000000006e-05, 3.9000000000000006e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 22:47:34,382] [INFO] [timer.py:198:stop] 0/156, RunningAvgSamplesPerSec=9.478168802057835, CurrSamplesPerSec=7.460844522751347, MemAllocated=4.57GB, MaxMemAllocated=10.4GB
[2022-11-23 22:47:50,066] [INFO] [timer.py:198:stop] 0/158, RunningAvgSamplesPerSec=9.464522751744804, CurrSamplesPerSec=7.492524542312993, MemAllocated=4.57GB, MaxMemAllocated=10.4GB
[2022-11-23 22:48:05,752] [INFO] [logging.py:68:log_dist] [Rank 0] step=80, skipped=0, lr=[4e-05, 4e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 22:48:05,752] [INFO] [timer.py:198:stop] 0/160, RunningAvgSamplesPerSec=9.449840723419994, CurrSamplesPerSec=7.393873260851362, MemAllocated=4.58GB, MaxMemAllocated=10.47GB
***** Evaluating perplexity, Epoch 1/2 *****
'step':160, 'ppl': 66.58645233496311, 'seq_len': 304, 'consume layer-tokens': 2187712
[2022-11-23 22:48:29,082] [INFO] [timer.py:198:stop] 0/162, RunningAvgSamplesPerSec=9.435892919207747, CurrSamplesPerSec=7.419246366044461, MemAllocated=4.57GB, MaxMemAllocated=10.48GB
[2022-11-23 22:48:44,759] [INFO] [logging.py:68:log_dist] [Rank 0] step=82, skipped=0, lr=[4.1e-05, 4.1e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 22:48:44,760] [INFO] [timer.py:198:stop] 0/164, RunningAvgSamplesPerSec=9.422440563296657, CurrSamplesPerSec=7.4436051128927065, MemAllocated=4.58GB, MaxMemAllocated=10.48GB
[2022-11-23 22:49:00,410] [INFO] [timer.py:198:stop] 0/166, RunningAvgSamplesPerSec=9.409261972067727, CurrSamplesPerSec=7.4516190640314885, MemAllocated=4.58GB, MaxMemAllocated=10.48GB
[2022-11-23 22:49:16,054] [INFO] [logging.py:68:log_dist] [Rank 0] step=84, skipped=0, lr=[4.2e-05, 4.2e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 22:49:16,055] [INFO] [timer.py:198:stop] 0/168, RunningAvgSamplesPerSec=9.395319038497108, CurrSamplesPerSec=7.358402251220171, MemAllocated=4.58GB, MaxMemAllocated=10.55GB
[2022-11-23 22:49:31,706] [INFO] [timer.py:198:stop] 0/170, RunningAvgSamplesPerSec=9.381961419075393, CurrSamplesPerSec=7.386704894878289, MemAllocated=4.58GB, MaxMemAllocated=10.55GB
***** Evaluating perplexity, Epoch 1/2 *****
'step':170, 'ppl': 67.56297369251739, 'seq_len': 312, 'consume layer-tokens': 2364544
[2022-11-23 22:49:54,929] [INFO] [logging.py:68:log_dist] [Rank 0] step=86, skipped=0, lr=[4.3e-05, 4.3e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 22:49:54,930] [INFO] [timer.py:198:stop] 0/172, RunningAvgSamplesPerSec=9.368917212508315, CurrSamplesPerSec=7.3695923561395205, MemAllocated=4.58GB, MaxMemAllocated=10.55GB
[2022-11-23 22:50:10,583] [INFO] [timer.py:198:stop] 0/174, RunningAvgSamplesPerSec=9.355428979841271, CurrSamplesPerSec=7.331302251843617, MemAllocated=4.58GB, MaxMemAllocated=10.62GB
[2022-11-23 22:50:26,235] [INFO] [logging.py:68:log_dist] [Rank 0] step=88, skipped=0, lr=[4.4000000000000006e-05, 4.4000000000000006e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 22:50:26,236] [INFO] [timer.py:198:stop] 0/176, RunningAvgSamplesPerSec=9.342310999578801, CurrSamplesPerSec=7.340315519686948, MemAllocated=4.58GB, MaxMemAllocated=10.62GB
[2022-11-23 22:50:41,902] [INFO] [timer.py:198:stop] 0/178, RunningAvgSamplesPerSec=9.329501004352867, CurrSamplesPerSec=7.326410371516758, MemAllocated=4.58GB, MaxMemAllocated=10.62GB
[2022-11-23 22:50:57,557] [INFO] [logging.py:68:log_dist] [Rank 0] step=90, skipped=0, lr=[4.5e-05, 4.5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 22:50:57,557] [INFO] [timer.py:198:stop] 0/180, RunningAvgSamplesPerSec=9.316949473664927, CurrSamplesPerSec=7.33368652773188, MemAllocated=4.58GB, MaxMemAllocated=10.63GB
***** Evaluating perplexity, Epoch 1/2 *****
'step':180, 'ppl': 68.64718231065723, 'seq_len': 328, 'consume layer-tokens': 2547008
[2022-11-23 22:51:20,842] [INFO] [timer.py:198:stop] 0/182, RunningAvgSamplesPerSec=9.297172990914007, CurrSamplesPerSec=6.937940206369738, MemAllocated=4.59GB, MaxMemAllocated=10.69GB
[2022-11-23 22:51:36,534] [INFO] [logging.py:68:log_dist] [Rank 0] step=92, skipped=0, lr=[4.600000000000001e-05, 4.600000000000001e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 22:51:36,535] [INFO] [timer.py:198:stop] 0/184, RunningAvgSamplesPerSec=9.277715259304818, CurrSamplesPerSec=6.915981205855898, MemAllocated=4.59GB, MaxMemAllocated=10.69GB
[2022-11-23 22:51:52,240] [INFO] [timer.py:198:stop] 0/186, RunningAvgSamplesPerSec=9.258804266969378, CurrSamplesPerSec=6.923424453235195, MemAllocated=4.59GB, MaxMemAllocated=10.7GB
[2022-11-23 22:52:07,942] [INFO] [logging.py:68:log_dist] [Rank 0] step=94, skipped=0, lr=[4.7e-05, 4.7e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 22:52:07,942] [INFO] [timer.py:198:stop] 0/188, RunningAvgSamplesPerSec=9.23961832683306, CurrSamplesPerSec=6.862470130212232, MemAllocated=4.59GB, MaxMemAllocated=10.78GB
[2022-11-23 22:52:23,652] [INFO] [timer.py:198:stop] 0/190, RunningAvgSamplesPerSec=9.221326337187897, CurrSamplesPerSec=6.920625649174131, MemAllocated=4.59GB, MaxMemAllocated=10.78GB
***** Evaluating perplexity, Epoch 1/2 *****
'step':190, 'ppl': 67.6652072981579, 'seq_len': 336, 'consume layer-tokens': 2734400
[2022-11-23 22:52:46,926] [INFO] [logging.py:68:log_dist] [Rank 0] step=96, skipped=0, lr=[4.8e-05, 4.8e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 22:52:46,927] [INFO] [timer.py:198:stop] 0/192, RunningAvgSamplesPerSec=9.2032187496927, CurrSamplesPerSec=6.89406445006398, MemAllocated=4.59GB, MaxMemAllocated=10.78GB
[2022-11-23 22:53:02,616] [INFO] [timer.py:198:stop] 0/194, RunningAvgSamplesPerSec=9.185689456880073, CurrSamplesPerSec=6.920751261246024, MemAllocated=4.59GB, MaxMemAllocated=10.78GB
[2022-11-23 22:53:18,294] [INFO] [logging.py:68:log_dist] [Rank 0] step=98, skipped=0, lr=[4.9e-05, 4.9e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 22:53:18,295] [INFO] [timer.py:198:stop] 0/196, RunningAvgSamplesPerSec=9.167145298178536, CurrSamplesPerSec=6.832043119870536, MemAllocated=4.59GB, MaxMemAllocated=10.85GB
[2022-11-23 22:53:33,983] [INFO] [timer.py:198:stop] 0/198, RunningAvgSamplesPerSec=9.148746645091174, CurrSamplesPerSec=6.827772401292202, MemAllocated=4.59GB, MaxMemAllocated=10.85GB
[2022-11-23 22:53:49,660] [INFO] [logging.py:68:log_dist] [Rank 0] step=100, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 22:53:49,661] [INFO] [timer.py:198:stop] 0/200, RunningAvgSamplesPerSec=9.131052294072566, CurrSamplesPerSec=6.825316933581656, MemAllocated=4.59GB, MaxMemAllocated=10.85GB
***** Evaluating perplexity, Epoch 1/2 *****
'step':200, 'ppl': 65.76817273915711, 'seq_len': 352, 'consume layer-tokens': 2926720
[2022-11-23 22:54:12,918] [INFO] [timer.py:198:stop] 0/202, RunningAvgSamplesPerSec=9.112792953279882, CurrSamplesPerSec=6.754765355750958, MemAllocated=4.6GB, MaxMemAllocated=10.93GB
[2022-11-23 22:54:28,597] [INFO] [logging.py:68:log_dist] [Rank 0] step=102, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 22:54:28,598] [INFO] [timer.py:198:stop] 0/204, RunningAvgSamplesPerSec=9.0953463055123, CurrSamplesPerSec=6.7850497073209, MemAllocated=4.6GB, MaxMemAllocated=10.93GB
[2022-11-23 22:54:44,281] [INFO] [timer.py:198:stop] 0/206, RunningAvgSamplesPerSec=9.077784740180247, CurrSamplesPerSec=6.758504116603945, MemAllocated=4.6GB, MaxMemAllocated=10.93GB
[2022-11-23 22:54:59,964] [INFO] [logging.py:68:log_dist] [Rank 0] step=104, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 22:54:59,965] [INFO] [timer.py:198:stop] 0/208, RunningAvgSamplesPerSec=9.060862127259389, CurrSamplesPerSec=6.758253648169289, MemAllocated=4.6GB, MaxMemAllocated=10.93GB
[2022-11-23 22:55:15,665] [INFO] [timer.py:198:stop] 0/210, RunningAvgSamplesPerSec=9.04251372849147, CurrSamplesPerSec=6.658920186861731, MemAllocated=4.6GB, MaxMemAllocated=11.01GB
***** Evaluating perplexity, Epoch 1/2 *****
'step':210, 'ppl': 64.00483722370444, 'seq_len': 360, 'consume layer-tokens': 3123968
[2022-11-23 22:55:38,942] [INFO] [logging.py:68:log_dist] [Rank 0] step=106, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 22:55:38,943] [INFO] [timer.py:198:stop] 0/212, RunningAvgSamplesPerSec=9.024630525316965, CurrSamplesPerSec=6.6638767478698275, MemAllocated=4.6GB, MaxMemAllocated=11.01GB
[2022-11-23 22:55:54,633] [INFO] [timer.py:198:stop] 0/214, RunningAvgSamplesPerSec=9.007486067540947, CurrSamplesPerSec=6.698384535103682, MemAllocated=4.6GB, MaxMemAllocated=11.01GB
[2022-11-23 22:56:10,327] [INFO] [logging.py:68:log_dist] [Rank 0] step=108, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 22:56:10,327] [INFO] [timer.py:198:stop] 0/216, RunningAvgSamplesPerSec=8.990470240965513, CurrSamplesPerSec=6.6749537887643235, MemAllocated=4.6GB, MaxMemAllocated=11.01GB
[2022-11-23 22:56:26,024] [INFO] [timer.py:198:stop] 0/218, RunningAvgSamplesPerSec=8.973192995687187, CurrSamplesPerSec=6.642968688132533, MemAllocated=4.61GB, MaxMemAllocated=11.09GB
[2022-11-23 22:56:41,725] [INFO] [logging.py:68:log_dist] [Rank 0] step=110, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 22:56:41,726] [INFO] [timer.py:198:stop] 0/220, RunningAvgSamplesPerSec=8.956162700762825, CurrSamplesPerSec=6.641706386280502, MemAllocated=4.61GB, MaxMemAllocated=11.09GB
***** Evaluating perplexity, Epoch 1/2 *****
'step':220, 'ppl': 61.61426974540337, 'seq_len': 368, 'consume layer-tokens': 3325440
[2022-11-23 22:57:05,001] [INFO] [timer.py:198:stop] 0/222, RunningAvgSamplesPerSec=8.939524698081732, CurrSamplesPerSec=6.622808347228538, MemAllocated=4.61GB, MaxMemAllocated=11.09GB
[2022-11-23 22:57:20,700] [INFO] [logging.py:68:log_dist] [Rank 0] step=112, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 22:57:20,701] [INFO] [timer.py:198:stop] 0/224, RunningAvgSamplesPerSec=8.92236061255732, CurrSamplesPerSec=6.578361363319118, MemAllocated=4.61GB, MaxMemAllocated=11.17GB
[2022-11-23 22:57:36,411] [INFO] [timer.py:198:stop] 0/226, RunningAvgSamplesPerSec=8.905681741790271, CurrSamplesPerSec=6.589109120871697, MemAllocated=4.61GB, MaxMemAllocated=11.17GB
[2022-11-23 22:57:52,128] [INFO] [logging.py:68:log_dist] [Rank 0] step=114, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 22:57:52,128] [INFO] [timer.py:198:stop] 0/228, RunningAvgSamplesPerSec=8.889501933386835, CurrSamplesPerSec=6.605712881781429, MemAllocated=4.61GB, MaxMemAllocated=11.17GB
[2022-11-23 22:58:07,843] [INFO] [timer.py:198:stop] 0/230, RunningAvgSamplesPerSec=8.873481822925223, CurrSamplesPerSec=6.573953576581244, MemAllocated=4.61GB, MaxMemAllocated=11.18GB
***** Evaluating perplexity, Epoch 1/2 *****
'step':230, 'ppl': 57.28824949673672, 'seq_len': 384, 'consume layer-tokens': 3532544
[2022-11-23 22:58:31,131] [INFO] [logging.py:68:log_dist] [Rank 0] step=116, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 22:58:31,132] [INFO] [timer.py:198:stop] 0/232, RunningAvgSamplesPerSec=8.857199974606095, CurrSamplesPerSec=6.529227617533924, MemAllocated=4.61GB, MaxMemAllocated=11.25GB
[2022-11-23 22:58:46,833] [INFO] [timer.py:198:stop] 0/234, RunningAvgSamplesPerSec=8.841320539372795, CurrSamplesPerSec=6.541197276726082, MemAllocated=4.61GB, MaxMemAllocated=11.26GB
[2022-11-23 22:59:02,539] [INFO] [logging.py:68:log_dist] [Rank 0] step=118, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 22:59:02,539] [INFO] [timer.py:198:stop] 0/236, RunningAvgSamplesPerSec=8.825909486246884, CurrSamplesPerSec=6.57776815910333, MemAllocated=4.62GB, MaxMemAllocated=11.26GB
[2022-11-23 22:59:18,249] [INFO] [timer.py:198:stop] 0/238, RunningAvgSamplesPerSec=8.809281971994718, CurrSamplesPerSec=6.468758193320728, MemAllocated=4.62GB, MaxMemAllocated=11.34GB
[2022-11-23 22:59:33,967] [INFO] [logging.py:68:log_dist] [Rank 0] step=120, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 22:59:33,968] [INFO] [timer.py:198:stop] 0/240, RunningAvgSamplesPerSec=8.793083795492915, CurrSamplesPerSec=6.477884662163571, MemAllocated=4.62GB, MaxMemAllocated=11.34GB
***** Evaluating perplexity, Epoch 1/2 *****
'step':240, 'ppl': 54.98321023273377, 'seq_len': 392, 'consume layer-tokens': 3744576
[2022-11-23 22:59:57,263] [INFO] [timer.py:198:stop] 0/242, RunningAvgSamplesPerSec=8.77708063819616, CurrSamplesPerSec=6.463459981153461, MemAllocated=4.62GB, MaxMemAllocated=11.34GB
[2022-11-23 23:00:12,980] [INFO] [logging.py:68:log_dist] [Rank 0] step=122, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:00:12,981] [INFO] [timer.py:198:stop] 0/244, RunningAvgSamplesPerSec=8.761505153686203, CurrSamplesPerSec=6.475509403783746, MemAllocated=4.62GB, MaxMemAllocated=11.34GB
[2022-11-23 23:00:28,701] [INFO] [timer.py:198:stop] 0/246, RunningAvgSamplesPerSec=8.745476075966463, CurrSamplesPerSec=6.413269643610742, MemAllocated=4.62GB, MaxMemAllocated=11.43GB
[2022-11-23 23:00:44,422] [INFO] [logging.py:68:log_dist] [Rank 0] step=124, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:00:44,423] [INFO] [timer.py:198:stop] 0/248, RunningAvgSamplesPerSec=8.729705227297048, CurrSamplesPerSec=6.406637736546501, MemAllocated=4.62GB, MaxMemAllocated=11.43GB
[2022-11-23 23:01:00,154] [INFO] [timer.py:198:stop] 0/250, RunningAvgSamplesPerSec=8.714356770174268, CurrSamplesPerSec=6.40359576910863, MemAllocated=4.62GB, MaxMemAllocated=11.43GB
***** Evaluating perplexity, Epoch 1/2 *****
'step':250, 'ppl': 54.253551716744674, 'seq_len': 408, 'consume layer-tokens': 3961536
[2022-11-23 23:01:23,457] [INFO] [logging.py:68:log_dist] [Rank 0] step=126, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:01:23,457] [INFO] [timer.py:198:stop] 0/252, RunningAvgSamplesPerSec=8.699013507132861, CurrSamplesPerSec=6.390784772323843, MemAllocated=4.63GB, MaxMemAllocated=11.51GB
[2022-11-23 23:01:39,197] [INFO] [timer.py:198:stop] 0/254, RunningAvgSamplesPerSec=8.683831317344925, CurrSamplesPerSec=6.394579789622291, MemAllocated=4.63GB, MaxMemAllocated=11.51GB
[2022-11-23 23:01:54,925] [INFO] [logging.py:68:log_dist] [Rank 0] step=128, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:01:54,926] [INFO] [timer.py:198:stop] 0/256, RunningAvgSamplesPerSec=8.668854383206831, CurrSamplesPerSec=6.379281158529769, MemAllocated=4.63GB, MaxMemAllocated=11.51GB
[2022-11-23 23:02:10,660] [INFO] [timer.py:198:stop] 0/258, RunningAvgSamplesPerSec=8.654250419459297, CurrSamplesPerSec=6.393644013862562, MemAllocated=4.63GB, MaxMemAllocated=11.51GB
[2022-11-23 23:02:26,386] [INFO] [logging.py:68:log_dist] [Rank 0] step=130, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:02:26,387] [INFO] [timer.py:198:stop] 0/260, RunningAvgSamplesPerSec=8.63933454804342, CurrSamplesPerSec=6.337199490220282, MemAllocated=4.63GB, MaxMemAllocated=11.59GB
***** Evaluating perplexity, Epoch 1/2 *****
'step':260, 'ppl': 53.09347406330683, 'seq_len': 416, 'consume layer-tokens': 4183424
[2022-11-23 23:02:49,695] [INFO] [timer.py:198:stop] 0/262, RunningAvgSamplesPerSec=8.6247152183389, CurrSamplesPerSec=6.3410461514272365, MemAllocated=4.63GB, MaxMemAllocated=11.59GB
[2022-11-23 23:03:05,423] [INFO] [logging.py:68:log_dist] [Rank 0] step=132, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:03:05,424] [INFO] [timer.py:198:stop] 0/264, RunningAvgSamplesPerSec=8.610350386363963, CurrSamplesPerSec=6.3530712616309275, MemAllocated=4.63GB, MaxMemAllocated=11.59GB
[2022-11-23 23:03:21,149] [INFO] [timer.py:198:stop] 0/266, RunningAvgSamplesPerSec=8.596263509213909, CurrSamplesPerSec=6.3536920015784615, MemAllocated=4.63GB, MaxMemAllocated=11.59GB
[2022-11-23 23:03:36,893] [INFO] [logging.py:68:log_dist] [Rank 0] step=134, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:03:36,894] [INFO] [timer.py:198:stop] 0/268, RunningAvgSamplesPerSec=8.58005146270406, CurrSamplesPerSec=6.173464123572195, MemAllocated=4.63GB, MaxMemAllocated=11.67GB
[2022-11-23 23:03:52,650] [INFO] [timer.py:198:stop] 0/270, RunningAvgSamplesPerSec=8.564352605910345, CurrSamplesPerSec=6.1992773946003386, MemAllocated=4.63GB, MaxMemAllocated=11.67GB
***** Evaluating perplexity, Epoch 1/2 *****
'step':270, 'ppl': 52.279541389840944, 'seq_len': 424, 'consume layer-tokens': 4409536
[2022-11-23 23:04:15,970] [INFO] [logging.py:68:log_dist] [Rank 0] step=136, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:04:15,971] [INFO] [timer.py:198:stop] 0/272, RunningAvgSamplesPerSec=8.548821592106883, CurrSamplesPerSec=6.172069656631772, MemAllocated=4.63GB, MaxMemAllocated=11.67GB
[2022-11-23 23:04:31,720] [INFO] [timer.py:198:stop] 0/274, RunningAvgSamplesPerSec=8.532620980886735, CurrSamplesPerSec=6.091843055635236, MemAllocated=4.64GB, MaxMemAllocated=11.76GB
[2022-11-23 23:04:47,534] [INFO] [logging.py:68:log_dist] [Rank 0] step=138, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:04:47,535] [INFO] [timer.py:198:stop] 0/276, RunningAvgSamplesPerSec=8.5167773869773, CurrSamplesPerSec=6.098251205313265, MemAllocated=4.64GB, MaxMemAllocated=11.76GB
[2022-11-23 23:05:03,369] [INFO] [timer.py:198:stop] 0/278, RunningAvgSamplesPerSec=8.501480649259376, CurrSamplesPerSec=6.127978388534469, MemAllocated=4.64GB, MaxMemAllocated=11.76GB
[2022-11-23 23:05:19,182] [INFO] [logging.py:68:log_dist] [Rank 0] step=140, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:05:19,182] [INFO] [timer.py:198:stop] 0/280, RunningAvgSamplesPerSec=8.486263494000443, CurrSamplesPerSec=6.117133002267871, MemAllocated=4.64GB, MaxMemAllocated=11.76GB
***** Evaluating perplexity, Epoch 1/2 *****
'step':280, 'ppl': 51.95884979746272, 'seq_len': 440, 'consume layer-tokens': 4641280
[2022-11-23 23:05:42,602] [INFO] [timer.py:198:stop] 0/282, RunningAvgSamplesPerSec=8.471062508858322, CurrSamplesPerSec=6.109394516072413, MemAllocated=4.64GB, MaxMemAllocated=11.84GB
[2022-11-23 23:05:58,451] [INFO] [logging.py:68:log_dist] [Rank 0] step=142, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:05:58,452] [INFO] [timer.py:198:stop] 0/284, RunningAvgSamplesPerSec=8.456213810137061, CurrSamplesPerSec=6.115723736299308, MemAllocated=4.64GB, MaxMemAllocated=11.84GB
[2022-11-23 23:06:14,248] [INFO] [timer.py:198:stop] 0/286, RunningAvgSamplesPerSec=8.441650008033045, CurrSamplesPerSec=6.11275569987, MemAllocated=4.64GB, MaxMemAllocated=11.84GB
[2022-11-23 23:06:30,059] [INFO] [logging.py:68:log_dist] [Rank 0] step=144, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:06:30,059] [INFO] [timer.py:198:stop] 0/288, RunningAvgSamplesPerSec=8.42673150564672, CurrSamplesPerSec=6.064691133815504, MemAllocated=4.65GB, MaxMemAllocated=11.94GB
[2022-11-23 23:06:45,863] [INFO] [timer.py:198:stop] 0/290, RunningAvgSamplesPerSec=8.4123776403772, CurrSamplesPerSec=6.09603096338359, MemAllocated=4.65GB, MaxMemAllocated=11.94GB
***** Evaluating perplexity, Epoch 1/2 *****
'step':290, 'ppl': 51.83179731186163, 'seq_len': 448, 'consume layer-tokens': 4877952
[2022-11-23 23:07:09,352] [INFO] [logging.py:68:log_dist] [Rank 0] step=146, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:07:09,353] [INFO] [timer.py:198:stop] 0/292, RunningAvgSamplesPerSec=8.398003657533415, CurrSamplesPerSec=6.073305889115901, MemAllocated=4.65GB, MaxMemAllocated=11.94GB
[2022-11-23 23:07:25,159] [INFO] [timer.py:198:stop] 0/294, RunningAvgSamplesPerSec=8.383970630601063, CurrSamplesPerSec=6.072892595488374, MemAllocated=4.65GB, MaxMemAllocated=11.94GB
[2022-11-23 23:07:40,987] [INFO] [logging.py:68:log_dist] [Rank 0] step=148, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:07:40,988] [INFO] [timer.py:198:stop] 0/296, RunningAvgSamplesPerSec=8.369466432449956, CurrSamplesPerSec=6.008945430581224, MemAllocated=4.65GB, MaxMemAllocated=12.03GB
[2022-11-23 23:07:56,827] [INFO] [timer.py:198:stop] 0/298, RunningAvgSamplesPerSec=8.355234961618828, CurrSamplesPerSec=6.012804596580662, MemAllocated=4.65GB, MaxMemAllocated=12.03GB
[2022-11-23 23:08:12,638] [INFO] [logging.py:68:log_dist] [Rank 0] step=150, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:08:12,638] [INFO] [timer.py:198:stop] 0/300, RunningAvgSamplesPerSec=8.341052969967594, CurrSamplesPerSec=5.987312499643128, MemAllocated=4.65GB, MaxMemAllocated=12.03GB
***** Evaluating perplexity, Epoch 1/2 *****
'step':300, 'ppl': 51.42621832268343, 'seq_len': 464, 'consume layer-tokens': 5119552
[2022-11-23 23:08:36,073] [INFO] [timer.py:198:stop] 0/302, RunningAvgSamplesPerSec=8.326877911875735, CurrSamplesPerSec=6.006256421638999, MemAllocated=4.65GB, MaxMemAllocated=12.11GB
[2022-11-23 23:08:51,951] [INFO] [logging.py:68:log_dist] [Rank 0] step=152, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:08:51,952] [INFO] [timer.py:198:stop] 0/304, RunningAvgSamplesPerSec=8.3127676752466, CurrSamplesPerSec=5.958783098399457, MemAllocated=4.66GB, MaxMemAllocated=12.12GB
[2022-11-23 23:09:07,774] [INFO] [timer.py:198:stop] 0/306, RunningAvgSamplesPerSec=8.299050867327948, CurrSamplesPerSec=5.9907973510425645, MemAllocated=4.66GB, MaxMemAllocated=12.12GB
[2022-11-23 23:09:23,552] [INFO] [logging.py:68:log_dist] [Rank 0] step=154, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:09:23,553] [INFO] [timer.py:198:stop] 0/308, RunningAvgSamplesPerSec=8.28555240746384, CurrSamplesPerSec=5.995562976008051, MemAllocated=4.66GB, MaxMemAllocated=12.12GB
[2022-11-23 23:09:39,369] [INFO] [timer.py:198:stop] 0/310, RunningAvgSamplesPerSec=8.27156818376401, CurrSamplesPerSec=5.939876211981847, MemAllocated=4.66GB, MaxMemAllocated=12.2GB
***** Evaluating perplexity, Epoch 1/2 *****
'step':310, 'ppl': 51.10069120488677, 'seq_len': 472, 'consume layer-tokens': 5366080
[2022-11-23 23:10:02,692] [INFO] [logging.py:68:log_dist] [Rank 0] step=156, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:10:02,693] [INFO] [timer.py:198:stop] 0/312, RunningAvgSamplesPerSec=8.257885643623107, CurrSamplesPerSec=5.94073014411671, MemAllocated=4.66GB, MaxMemAllocated=12.21GB
[2022-11-23 23:10:18,473] [INFO] [timer.py:198:stop] 0/314, RunningAvgSamplesPerSec=8.244313099067197, CurrSamplesPerSec=5.938089217783529, MemAllocated=4.66GB, MaxMemAllocated=12.21GB
[2022-11-23 23:10:34,233] [INFO] [logging.py:68:log_dist] [Rank 0] step=158, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:10:34,234] [INFO] [timer.py:198:stop] 0/316, RunningAvgSamplesPerSec=8.231133570042509, CurrSamplesPerSec=5.937887460130273, MemAllocated=4.66GB, MaxMemAllocated=12.21GB
[2022-11-23 23:10:50,013] [INFO] [timer.py:198:stop] 0/318, RunningAvgSamplesPerSec=8.217797719662927, CurrSamplesPerSec=5.912179348481079, MemAllocated=4.66GB, MaxMemAllocated=12.3GB
[2022-11-23 23:11:05,776] [INFO] [logging.py:68:log_dist] [Rank 0] step=160, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:11:05,777] [INFO] [timer.py:198:stop] 0/320, RunningAvgSamplesPerSec=8.204580396922001, CurrSamplesPerSec=5.90499198927774, MemAllocated=4.66GB, MaxMemAllocated=12.3GB
***** Evaluating perplexity, Epoch 1/2 *****
'step':320, 'ppl': 51.069809935298146, 'seq_len': 480, 'consume layer-tokens': 5616832
[2022-11-23 23:11:29,093] [INFO] [timer.py:198:stop] 0/322, RunningAvgSamplesPerSec=8.191650839882566, CurrSamplesPerSec=5.921582136584649, MemAllocated=4.66GB, MaxMemAllocated=12.3GB
[2022-11-23 23:11:44,845] [INFO] [logging.py:68:log_dist] [Rank 0] step=162, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:11:44,845] [INFO] [timer.py:198:stop] 0/324, RunningAvgSamplesPerSec=8.176752259575055, CurrSamplesPerSec=5.748704956151141, MemAllocated=4.67GB, MaxMemAllocated=12.38GB
[2022-11-23 23:12:00,617] [INFO] [timer.py:198:stop] 0/326, RunningAvgSamplesPerSec=8.16218505658926, CurrSamplesPerSec=5.755058637244907, MemAllocated=4.67GB, MaxMemAllocated=12.38GB
[2022-11-23 23:12:16,398] [INFO] [logging.py:68:log_dist] [Rank 0] step=164, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:12:16,399] [INFO] [timer.py:198:stop] 0/328, RunningAvgSamplesPerSec=8.14746422728405, CurrSamplesPerSec=5.7123455487042945, MemAllocated=4.67GB, MaxMemAllocated=12.39GB
[2022-11-23 23:12:32,159] [INFO] [timer.py:198:stop] 0/330, RunningAvgSamplesPerSec=8.133310379840013, CurrSamplesPerSec=5.74321448817345, MemAllocated=4.67GB, MaxMemAllocated=12.39GB
***** Evaluating perplexity, Epoch 1/2 *****
'step':330, 'ppl': 50.718901242774685, 'seq_len': 496, 'consume layer-tokens': 5873216
[2022-11-23 23:12:55,505] [INFO] [logging.py:68:log_dist] [Rank 0] step=166, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:12:55,506] [INFO] [timer.py:198:stop] 0/332, RunningAvgSamplesPerSec=8.118942777480227, CurrSamplesPerSec=5.714649301423177, MemAllocated=4.67GB, MaxMemAllocated=12.48GB
[2022-11-23 23:13:11,277] [INFO] [timer.py:198:stop] 0/334, RunningAvgSamplesPerSec=8.104618057714166, CurrSamplesPerSec=5.691208507156576, MemAllocated=4.67GB, MaxMemAllocated=12.48GB
[2022-11-23 23:13:27,056] [INFO] [logging.py:68:log_dist] [Rank 0] step=168, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:13:27,056] [INFO] [timer.py:198:stop] 0/336, RunningAvgSamplesPerSec=8.090626168671319, CurrSamplesPerSec=5.693445004004398, MemAllocated=4.67GB, MaxMemAllocated=12.48GB
[2022-11-23 23:13:42,914] [INFO] [timer.py:198:stop] 0/338, RunningAvgSamplesPerSec=8.07426422944861, CurrSamplesPerSec=5.342912682701886, MemAllocated=4.68GB, MaxMemAllocated=12.57GB
[2022-11-23 23:13:58,992] [INFO] [logging.py:68:log_dist] [Rank 0] step=170, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:13:58,992] [INFO] [timer.py:198:stop] 0/340, RunningAvgSamplesPerSec=8.059248910330576, CurrSamplesPerSec=5.635486751049523, MemAllocated=4.68GB, MaxMemAllocated=12.57GB
***** Evaluating perplexity, Epoch 1/2 *****
'step':340, 'ppl': 51.39828346321657, 'seq_len': 504, 'consume layer-tokens': 6134528
[2022-11-23 23:14:22,807] [INFO] [timer.py:198:stop] 0/342, RunningAvgSamplesPerSec=8.04429790132295, CurrSamplesPerSec=5.499298542804622, MemAllocated=4.68GB, MaxMemAllocated=12.57GB
[2022-11-23 23:14:38,845] [INFO] [logging.py:68:log_dist] [Rank 0] step=172, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:14:38,846] [INFO] [timer.py:198:stop] 0/344, RunningAvgSamplesPerSec=8.03012290930296, CurrSamplesPerSec=5.598941163985426, MemAllocated=4.68GB, MaxMemAllocated=12.57GB
[2022-11-23 23:14:54,901] [INFO] [timer.py:198:stop] 0/346, RunningAvgSamplesPerSec=8.016187554357098, CurrSamplesPerSec=5.58632368894397, MemAllocated=4.68GB, MaxMemAllocated=12.66GB
[2022-11-23 23:15:10,957] [INFO] [logging.py:68:log_dist] [Rank 0] step=174, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:15:10,958] [INFO] [timer.py:198:stop] 0/348, RunningAvgSamplesPerSec=8.002838237296173, CurrSamplesPerSec=5.660317826617085, MemAllocated=4.68GB, MaxMemAllocated=12.66GB
[2022-11-23 23:15:26,872] [INFO] [timer.py:198:stop] 0/350, RunningAvgSamplesPerSec=7.989675774413806, CurrSamplesPerSec=5.642582942580723, MemAllocated=4.68GB, MaxMemAllocated=12.66GB
***** Evaluating perplexity, Epoch 1/2 *****
'step':350, 'ppl': 51.062975602729125, 'seq_len': 520, 'consume layer-tokens': 6400768
[2022-11-23 23:15:50,264] [INFO] [logging.py:68:log_dist] [Rank 0] step=176, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:15:50,264] [INFO] [timer.py:198:stop] 0/352, RunningAvgSamplesPerSec=7.97515043055126, CurrSamplesPerSec=5.524887524525285, MemAllocated=4.68GB, MaxMemAllocated=12.79GB
[2022-11-23 23:16:06,083] [INFO] [timer.py:198:stop] 0/354, RunningAvgSamplesPerSec=7.96062859501321, CurrSamplesPerSec=5.50421316059878, MemAllocated=4.68GB, MaxMemAllocated=12.79GB
[2022-11-23 23:16:21,889] [INFO] [logging.py:68:log_dist] [Rank 0] step=178, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:16:21,890] [INFO] [timer.py:198:stop] 0/356, RunningAvgSamplesPerSec=7.946444802419582, CurrSamplesPerSec=5.511101884268679, MemAllocated=4.68GB, MaxMemAllocated=12.79GB
[2022-11-23 23:16:37,719] [INFO] [timer.py:198:stop] 0/358, RunningAvgSamplesPerSec=7.932482628339419, CurrSamplesPerSec=5.508980997757296, MemAllocated=4.68GB, MaxMemAllocated=12.79GB
[2022-11-23 23:16:53,541] [INFO] [logging.py:68:log_dist] [Rank 0] step=180, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:16:53,542] [INFO] [timer.py:198:stop] 0/360, RunningAvgSamplesPerSec=7.918426060603833, CurrSamplesPerSec=5.491921476714382, MemAllocated=4.69GB, MaxMemAllocated=12.89GB
***** Evaluating perplexity, Epoch 1/2 *****
'step':360, 'ppl': 50.16251303385439, 'seq_len': 528, 'consume layer-tokens': 6671936
[2022-11-23 23:17:16,937] [INFO] [timer.py:198:stop] 0/362, RunningAvgSamplesPerSec=7.904621217237259, CurrSamplesPerSec=5.489765026553537, MemAllocated=4.69GB, MaxMemAllocated=12.89GB
[2022-11-23 23:17:32,758] [INFO] [logging.py:68:log_dist] [Rank 0] step=182, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:17:32,758] [INFO] [timer.py:198:stop] 0/364, RunningAvgSamplesPerSec=7.890953876677611, CurrSamplesPerSec=5.478414144099017, MemAllocated=4.69GB, MaxMemAllocated=12.89GB
[2022-11-23 23:17:48,550] [INFO] [timer.py:198:stop] 0/366, RunningAvgSamplesPerSec=7.877763984521308, CurrSamplesPerSec=5.509317479978616, MemAllocated=4.69GB, MaxMemAllocated=12.89GB
[2022-11-23 23:18:04,303] [INFO] [logging.py:68:log_dist] [Rank 0] step=184, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:18:04,303] [INFO] [timer.py:198:stop] 0/368, RunningAvgSamplesPerSec=7.864030698747706, CurrSamplesPerSec=5.448549107432821, MemAllocated=4.69GB, MaxMemAllocated=12.98GB
[2022-11-23 23:18:20,045] [INFO] [timer.py:198:stop] 0/370, RunningAvgSamplesPerSec=7.850461708476005, CurrSamplesPerSec=5.423380264024738, MemAllocated=4.69GB, MaxMemAllocated=12.98GB
***** Evaluating perplexity, Epoch 1/2 *****
'step':370, 'ppl': 49.377640866009756, 'seq_len': 536, 'consume layer-tokens': 6947328
[2022-11-23 23:18:43,297] [INFO] [logging.py:68:log_dist] [Rank 0] step=186, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:18:43,298] [INFO] [timer.py:198:stop] 0/372, RunningAvgSamplesPerSec=7.837260672671469, CurrSamplesPerSec=5.457815600621995, MemAllocated=4.69GB, MaxMemAllocated=12.99GB
[2022-11-23 23:18:59,019] [INFO] [timer.py:198:stop] 0/374, RunningAvgSamplesPerSec=7.823853680098206, CurrSamplesPerSec=5.42487787149119, MemAllocated=4.7GB, MaxMemAllocated=13.09GB
[2022-11-23 23:19:14,700] [INFO] [logging.py:68:log_dist] [Rank 0] step=188, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:19:14,701] [INFO] [timer.py:198:stop] 0/376, RunningAvgSamplesPerSec=7.810906310240264, CurrSamplesPerSec=5.448839315060129, MemAllocated=4.7GB, MaxMemAllocated=13.1GB
[2022-11-23 23:19:30,380] [INFO] [timer.py:198:stop] 0/378, RunningAvgSamplesPerSec=7.798038294765087, CurrSamplesPerSec=5.4383442907034265, MemAllocated=4.7GB, MaxMemAllocated=13.1GB
[2022-11-23 23:19:46,057] [INFO] [logging.py:68:log_dist] [Rank 0] step=190, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:19:46,058] [INFO] [timer.py:198:stop] 0/380, RunningAvgSamplesPerSec=7.78510579550709, CurrSamplesPerSec=5.386162008479316, MemAllocated=4.7GB, MaxMemAllocated=13.1GB
***** Evaluating perplexity, Epoch 1/2 *****
'step':380, 'ppl': 49.0421375538307, 'seq_len': 552, 'consume layer-tokens': 7228352
[2022-11-23 23:20:09,245] [INFO] [timer.py:198:stop] 0/382, RunningAvgSamplesPerSec=7.772280267183661, CurrSamplesPerSec=5.40342243481644, MemAllocated=4.7GB, MaxMemAllocated=13.18GB
[2022-11-23 23:20:24,935] [INFO] [logging.py:68:log_dist] [Rank 0] step=192, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:20:24,936] [INFO] [timer.py:198:stop] 0/384, RunningAvgSamplesPerSec=7.759638872368264, CurrSamplesPerSec=5.4059295939660075, MemAllocated=4.7GB, MaxMemAllocated=13.18GB
[2022-11-23 23:20:40,605] [INFO] [timer.py:198:stop] 0/386, RunningAvgSamplesPerSec=7.747149023843132, CurrSamplesPerSec=5.397070943691939, MemAllocated=4.7GB, MaxMemAllocated=13.18GB
[2022-11-23 23:20:56,294] [INFO] [logging.py:68:log_dist] [Rank 0] step=194, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:20:56,295] [INFO] [timer.py:198:stop] 0/388, RunningAvgSamplesPerSec=7.734373939375887, CurrSamplesPerSec=5.361945347660647, MemAllocated=4.7GB, MaxMemAllocated=13.27GB
[2022-11-23 23:21:11,989] [INFO] [timer.py:198:stop] 0/390, RunningAvgSamplesPerSec=7.721761273733121, CurrSamplesPerSec=5.349079282811111, MemAllocated=4.7GB, MaxMemAllocated=13.27GB
***** Evaluating perplexity, Epoch 1/2 *****
'step':390, 'ppl': 48.4249592387716, 'seq_len': 560, 'consume layer-tokens': 7514304
[2022-11-23 23:21:35,162] [INFO] [logging.py:68:log_dist] [Rank 0] step=196, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:21:35,163] [INFO] [timer.py:198:stop] 0/392, RunningAvgSamplesPerSec=7.709354742162463, CurrSamplesPerSec=5.36755488099839, MemAllocated=4.7GB, MaxMemAllocated=13.27GB
[2022-11-23 23:21:50,843] [INFO] [timer.py:198:stop] 0/394, RunningAvgSamplesPerSec=7.697148020502537, CurrSamplesPerSec=5.368001402695069, MemAllocated=4.7GB, MaxMemAllocated=13.27GB
[2022-11-23 23:22:06,526] [INFO] [logging.py:68:log_dist] [Rank 0] step=198, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:22:06,527] [INFO] [timer.py:198:stop] 0/396, RunningAvgSamplesPerSec=7.68493070759763, CurrSamplesPerSec=5.341643652609466, MemAllocated=4.71GB, MaxMemAllocated=13.37GB
[2022-11-23 23:22:22,207] [INFO] [timer.py:198:stop] 0/398, RunningAvgSamplesPerSec=7.672915011571141, CurrSamplesPerSec=5.365086613518552, MemAllocated=4.71GB, MaxMemAllocated=13.37GB
[2022-11-23 23:22:37,890] [INFO] [logging.py:68:log_dist] [Rank 0] step=200, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:22:37,891] [INFO] [timer.py:198:stop] 0/400, RunningAvgSamplesPerSec=7.661091888747394, CurrSamplesPerSec=5.362459495205907, MemAllocated=4.71GB, MaxMemAllocated=13.37GB
***** Evaluating perplexity, Epoch 1/2 *****
'step':400, 'ppl': 47.406085131893555, 'seq_len': 576, 'consume layer-tokens': 7805184
[2022-11-23 23:23:01,078] [INFO] [timer.py:198:stop] 0/402, RunningAvgSamplesPerSec=7.649466604755282, CurrSamplesPerSec=5.362521199537429, MemAllocated=4.71GB, MaxMemAllocated=13.47GB
[2022-11-23 23:23:16,761] [INFO] [logging.py:68:log_dist] [Rank 0] step=202, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:23:16,762] [INFO] [timer.py:198:stop] 0/404, RunningAvgSamplesPerSec=7.63786889002245, CurrSamplesPerSec=5.3526016429279695, MemAllocated=4.71GB, MaxMemAllocated=13.47GB
[2022-11-23 23:23:32,435] [INFO] [timer.py:198:stop] 0/406, RunningAvgSamplesPerSec=7.626445450116288, CurrSamplesPerSec=5.3497786074109595, MemAllocated=4.71GB, MaxMemAllocated=13.48GB
[2022-11-23 23:23:48,119] [INFO] [logging.py:68:log_dist] [Rank 0] step=204, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:23:48,120] [INFO] [timer.py:198:stop] 0/408, RunningAvgSamplesPerSec=7.615201257808534, CurrSamplesPerSec=5.35686744310497, MemAllocated=4.71GB, MaxMemAllocated=13.48GB
[2022-11-23 23:24:03,811] [INFO] [timer.py:198:stop] 0/410, RunningAvgSamplesPerSec=7.603358700232833, CurrSamplesPerSec=5.284105933983699, MemAllocated=4.72GB, MaxMemAllocated=13.57GB
***** Evaluating perplexity, Epoch 1/2 *****
'step':410, 'ppl': 46.54281078352063, 'seq_len': 584, 'consume layer-tokens': 8100992
[2022-11-23 23:24:27,006] [INFO] [logging.py:68:log_dist] [Rank 0] step=206, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:24:27,006] [INFO] [timer.py:198:stop] 0/412, RunningAvgSamplesPerSec=7.5915981772443875, CurrSamplesPerSec=5.2773244369343155, MemAllocated=4.72GB, MaxMemAllocated=13.57GB
[2022-11-23 23:24:42,693] [INFO] [timer.py:198:stop] 0/414, RunningAvgSamplesPerSec=7.580028246403141, CurrSamplesPerSec=5.2840193934904445, MemAllocated=4.72GB, MaxMemAllocated=13.57GB
[2022-11-23 23:24:58,390] [INFO] [logging.py:68:log_dist] [Rank 0] step=208, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:24:58,390] [INFO] [timer.py:198:stop] 0/416, RunningAvgSamplesPerSec=7.568513015409213, CurrSamplesPerSec=5.275465893390235, MemAllocated=4.72GB, MaxMemAllocated=13.57GB
[2022-11-23 23:25:14,088] [INFO] [timer.py:198:stop] 0/418, RunningAvgSamplesPerSec=7.557035353856051, CurrSamplesPerSec=5.265650648021036, MemAllocated=4.72GB, MaxMemAllocated=13.66GB
[2022-11-23 23:25:29,777] [INFO] [logging.py:68:log_dist] [Rank 0] step=210, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:25:29,777] [INFO] [timer.py:198:stop] 0/420, RunningAvgSamplesPerSec=7.54564586527992, CurrSamplesPerSec=5.245834060305209, MemAllocated=4.72GB, MaxMemAllocated=13.67GB
***** Evaluating perplexity, Epoch 1/2 *****
'step':420, 'ppl': 45.142320170079756, 'seq_len': 592, 'consume layer-tokens': 8401024
[2022-11-23 23:25:52,974] [INFO] [timer.py:198:stop] 0/422, RunningAvgSamplesPerSec=7.534490400498655, CurrSamplesPerSec=5.264596460399146, MemAllocated=4.72GB, MaxMemAllocated=13.67GB
[2022-11-23 23:26:08,690] [INFO] [logging.py:68:log_dist] [Rank 0] step=212, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:26:08,691] [INFO] [timer.py:198:stop] 0/424, RunningAvgSamplesPerSec=7.523071909450655, CurrSamplesPerSec=5.210221679236834, MemAllocated=4.72GB, MaxMemAllocated=13.77GB
[2022-11-23 23:26:24,390] [INFO] [timer.py:198:stop] 0/426, RunningAvgSamplesPerSec=7.5118359031761575, CurrSamplesPerSec=5.222398406250487, MemAllocated=4.72GB, MaxMemAllocated=13.77GB
[2022-11-23 23:26:40,104] [INFO] [logging.py:68:log_dist] [Rank 0] step=214, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:26:40,104] [INFO] [timer.py:198:stop] 0/428, RunningAvgSamplesPerSec=7.500447933619565, CurrSamplesPerSec=5.165663023418069, MemAllocated=4.72GB, MaxMemAllocated=13.77GB
[2022-11-23 23:26:55,809] [INFO] [timer.py:198:stop] 0/430, RunningAvgSamplesPerSec=7.489386951327673, CurrSamplesPerSec=5.216873883689806, MemAllocated=4.72GB, MaxMemAllocated=13.77GB
***** Evaluating perplexity, Epoch 1/2 *****
'step':430, 'ppl': 43.08194018854463, 'seq_len': 608, 'consume layer-tokens': 8706688
[2022-11-23 23:27:19,033] [INFO] [logging.py:68:log_dist] [Rank 0] step=216, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:27:19,034] [INFO] [timer.py:198:stop] 0/432, RunningAvgSamplesPerSec=7.478368329112196, CurrSamplesPerSec=5.2005378707238, MemAllocated=4.73GB, MaxMemAllocated=13.88GB
[2022-11-23 23:27:34,729] [INFO] [timer.py:198:stop] 0/434, RunningAvgSamplesPerSec=7.467501476663378, CurrSamplesPerSec=5.213475995386023, MemAllocated=4.73GB, MaxMemAllocated=13.88GB
[2022-11-23 23:27:50,426] [INFO] [logging.py:68:log_dist] [Rank 0] step=218, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:27:50,426] [INFO] [timer.py:198:stop] 0/436, RunningAvgSamplesPerSec=7.45665377947301, CurrSamplesPerSec=5.190058182844104, MemAllocated=4.73GB, MaxMemAllocated=13.88GB
[2022-11-23 23:28:06,133] [INFO] [timer.py:198:stop] 0/438, RunningAvgSamplesPerSec=7.4450497652616825, CurrSamplesPerSec=5.12615426357205, MemAllocated=4.73GB, MaxMemAllocated=13.98GB
[2022-11-23 23:28:21,841] [INFO] [logging.py:68:log_dist] [Rank 0] step=220, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:28:21,841] [INFO] [timer.py:198:stop] 0/440, RunningAvgSamplesPerSec=7.433789774002094, CurrSamplesPerSec=5.1210127002654335, MemAllocated=4.73GB, MaxMemAllocated=13.98GB
***** Evaluating perplexity, Epoch 1/2 *****
'step':440, 'ppl': 42.05009716259843, 'seq_len': 616, 'consume layer-tokens': 9017280
[2022-11-23 23:28:45,068] [INFO] [timer.py:198:stop] 0/442, RunningAvgSamplesPerSec=7.422594729456075, CurrSamplesPerSec=5.1227358360941055, MemAllocated=4.73GB, MaxMemAllocated=13.98GB
[2022-11-23 23:29:00,768] [INFO] [logging.py:68:log_dist] [Rank 0] step=222, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:29:00,769] [INFO] [timer.py:198:stop] 0/444, RunningAvgSamplesPerSec=7.411551173676505, CurrSamplesPerSec=5.116839452193835, MemAllocated=4.73GB, MaxMemAllocated=13.98GB
[2022-11-23 23:29:16,473] [INFO] [timer.py:198:stop] 0/446, RunningAvgSamplesPerSec=7.40044924681641, CurrSamplesPerSec=5.101783792002433, MemAllocated=4.74GB, MaxMemAllocated=14.09GB
[2022-11-23 23:29:32,177] [INFO] [logging.py:68:log_dist] [Rank 0] step=224, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:29:32,177] [INFO] [timer.py:198:stop] 0/448, RunningAvgSamplesPerSec=7.389353146750077, CurrSamplesPerSec=5.078406290277567, MemAllocated=4.74GB, MaxMemAllocated=14.09GB
[2022-11-23 23:29:47,900] [INFO] [timer.py:198:stop] 0/450, RunningAvgSamplesPerSec=7.378575183607787, CurrSamplesPerSec=5.102643413243404, MemAllocated=4.74GB, MaxMemAllocated=14.09GB
***** Evaluating perplexity, Epoch 1/2 *****
'step':450, 'ppl': 42.086301301711615, 'seq_len': 632, 'consume layer-tokens': 9332800
[2022-11-23 23:30:11,110] [INFO] [logging.py:68:log_dist] [Rank 0] step=226, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:30:11,110] [INFO] [timer.py:198:stop] 0/452, RunningAvgSamplesPerSec=7.367571988184931, CurrSamplesPerSec=5.072540906037204, MemAllocated=4.74GB, MaxMemAllocated=14.19GB
[2022-11-23 23:30:26,826] [INFO] [timer.py:198:stop] 0/454, RunningAvgSamplesPerSec=7.356759478658146, CurrSamplesPerSec=5.068057361321224, MemAllocated=4.74GB, MaxMemAllocated=14.19GB
[2022-11-23 23:30:42,547] [INFO] [logging.py:68:log_dist] [Rank 0] step=228, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:30:42,548] [INFO] [timer.py:198:stop] 0/456, RunningAvgSamplesPerSec=7.346031535507387, CurrSamplesPerSec=5.062704669203871, MemAllocated=4.74GB, MaxMemAllocated=14.19GB
[2022-11-23 23:30:58,280] [INFO] [timer.py:198:stop] 0/458, RunningAvgSamplesPerSec=7.335533329351327, CurrSamplesPerSec=5.0828773738673725, MemAllocated=4.74GB, MaxMemAllocated=14.19GB
[2022-11-23 23:31:14,000] [INFO] [logging.py:68:log_dist] [Rank 0] step=230, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:31:14,000] [INFO] [timer.py:198:stop] 0/460, RunningAvgSamplesPerSec=7.324753717234629, CurrSamplesPerSec=5.041067176906519, MemAllocated=4.74GB, MaxMemAllocated=14.3GB
***** Evaluating perplexity, Epoch 1/2 *****
'step':460, 'ppl': 40.23177766272607, 'seq_len': 640, 'consume layer-tokens': 9653248
[2022-11-23 23:31:37,228] [INFO] [timer.py:198:stop] 0/462, RunningAvgSamplesPerSec=7.314117447859553, CurrSamplesPerSec=5.035952703416611, MemAllocated=4.74GB, MaxMemAllocated=14.3GB
[2022-11-23 23:31:52,985] [INFO] [logging.py:68:log_dist] [Rank 0] step=232, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:31:52,985] [INFO] [timer.py:198:stop] 0/464, RunningAvgSamplesPerSec=7.303615027367397, CurrSamplesPerSec=5.038771945420864, MemAllocated=4.74GB, MaxMemAllocated=14.3GB
[2022-11-23 23:32:08,722] [INFO] [timer.py:198:stop] 0/466, RunningAvgSamplesPerSec=7.293179155326738, CurrSamplesPerSec=5.0331788929009, MemAllocated=4.74GB, MaxMemAllocated=14.3GB
[2022-11-23 23:32:24,490] [INFO] [logging.py:68:log_dist] [Rank 0] step=234, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:32:24,491] [INFO] [timer.py:198:stop] 0/468, RunningAvgSamplesPerSec=7.280489419531852, CurrSamplesPerSec=4.78410796654789, MemAllocated=4.75GB, MaxMemAllocated=14.4GB
[2022-11-23 23:32:40,258] [INFO] [timer.py:198:stop] 0/470, RunningAvgSamplesPerSec=7.268000706645125, CurrSamplesPerSec=4.792118370683593, MemAllocated=4.75GB, MaxMemAllocated=14.4GB
***** Evaluating perplexity, Epoch 1/2 *****
'step':470, 'ppl': 38.389459413293736, 'seq_len': 648, 'consume layer-tokens': 9977920
[2022-11-23 23:33:03,514] [INFO] [logging.py:68:log_dist] [Rank 0] step=236, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:33:03,515] [INFO] [timer.py:198:stop] 0/472, RunningAvgSamplesPerSec=7.255720395850035, CurrSamplesPerSec=4.781735413856907, MemAllocated=4.75GB, MaxMemAllocated=14.41GB
[2022-11-23 23:33:19,297] [INFO] [timer.py:198:stop] 0/474, RunningAvgSamplesPerSec=7.243274238413986, CurrSamplesPerSec=4.764903586994369, MemAllocated=4.75GB, MaxMemAllocated=14.51GB
[2022-11-23 23:33:35,075] [INFO] [logging.py:68:log_dist] [Rank 0] step=238, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:33:35,075] [INFO] [timer.py:198:stop] 0/476, RunningAvgSamplesPerSec=7.231103730818156, CurrSamplesPerSec=4.778651888934588, MemAllocated=4.75GB, MaxMemAllocated=14.52GB
[2022-11-23 23:33:50,859] [INFO] [timer.py:198:stop] 0/478, RunningAvgSamplesPerSec=7.218977549362628, CurrSamplesPerSec=4.773102320089902, MemAllocated=4.75GB, MaxMemAllocated=14.52GB
[2022-11-23 23:34:06,644] [INFO] [logging.py:68:log_dist] [Rank 0] step=240, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:34:06,645] [INFO] [timer.py:198:stop] 0/480, RunningAvgSamplesPerSec=7.207038986751249, CurrSamplesPerSec=4.767440988155006, MemAllocated=4.75GB, MaxMemAllocated=14.52GB
***** Evaluating perplexity, Epoch 1/2 *****
'step':480, 'ppl': 37.43827675904666, 'seq_len': 664, 'consume layer-tokens': 10308224
[2022-11-23 23:34:29,936] [INFO] [timer.py:198:stop] 0/482, RunningAvgSamplesPerSec=7.194738384066567, CurrSamplesPerSec=4.720455399769059, MemAllocated=4.76GB, MaxMemAllocated=14.62GB
[2022-11-23 23:34:45,715] [INFO] [logging.py:68:log_dist] [Rank 0] step=242, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:34:45,716] [INFO] [timer.py:198:stop] 0/484, RunningAvgSamplesPerSec=7.182658069178216, CurrSamplesPerSec=4.724815763564555, MemAllocated=4.76GB, MaxMemAllocated=14.63GB
[2022-11-23 23:35:01,504] [INFO] [timer.py:198:stop] 0/486, RunningAvgSamplesPerSec=7.170665932005753, CurrSamplesPerSec=4.726506239291053, MemAllocated=4.76GB, MaxMemAllocated=14.63GB
[2022-11-23 23:35:17,295] [INFO] [logging.py:68:log_dist] [Rank 0] step=244, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:35:17,296] [INFO] [timer.py:198:stop] 0/488, RunningAvgSamplesPerSec=7.1587493299181, CurrSamplesPerSec=4.716235650762988, MemAllocated=4.76GB, MaxMemAllocated=14.74GB
[2022-11-23 23:35:33,092] [INFO] [timer.py:198:stop] 0/490, RunningAvgSamplesPerSec=7.146921523233015, CurrSamplesPerSec=4.709412472077084, MemAllocated=4.76GB, MaxMemAllocated=14.74GB
***** Evaluating perplexity, Epoch 1/2 *****
'step':490, 'ppl': 36.18338555240476, 'seq_len': 672, 'consume layer-tokens': 10643456
[2022-11-23 23:35:56,385] [INFO] [logging.py:68:log_dist] [Rank 0] step=246, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:35:56,386] [INFO] [timer.py:198:stop] 0/492, RunningAvgSamplesPerSec=7.135152405637201, CurrSamplesPerSec=4.704333752438079, MemAllocated=4.76GB, MaxMemAllocated=14.74GB
[2022-11-23 23:36:12,180] [INFO] [timer.py:198:stop] 0/494, RunningAvgSamplesPerSec=7.123505617391855, CurrSamplesPerSec=4.703690121733084, MemAllocated=4.76GB, MaxMemAllocated=14.74GB
[2022-11-23 23:36:27,981] [INFO] [logging.py:68:log_dist] [Rank 0] step=248, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:36:27,982] [INFO] [timer.py:198:stop] 0/496, RunningAvgSamplesPerSec=7.111389942913606, CurrSamplesPerSec=4.633737549942469, MemAllocated=4.76GB, MaxMemAllocated=14.83GB
[2022-11-23 23:36:43,788] [INFO] [timer.py:198:stop] 0/498, RunningAvgSamplesPerSec=7.099413337147397, CurrSamplesPerSec=4.634326333915805, MemAllocated=4.76GB, MaxMemAllocated=14.83GB
[2022-11-23 23:36:59,586] [INFO] [logging.py:68:log_dist] [Rank 0] step=250, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:36:59,587] [INFO] [timer.py:198:stop] 0/500, RunningAvgSamplesPerSec=7.087625423316847, CurrSamplesPerSec=4.642880546921353, MemAllocated=4.76GB, MaxMemAllocated=14.83GB
***** Evaluating perplexity, Epoch 1/2 *****
'step':500, 'ppl': 35.19373152570843, 'seq_len': 688, 'consume layer-tokens': 10983616
[2022-11-23 23:37:22,870] [INFO] [timer.py:198:stop] 0/502, RunningAvgSamplesPerSec=7.075765227092811, CurrSamplesPerSec=4.625347027514629, MemAllocated=4.77GB, MaxMemAllocated=14.94GB
[2022-11-23 23:37:38,698] [INFO] [logging.py:68:log_dist] [Rank 0] step=252, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:37:38,698] [INFO] [timer.py:198:stop] 0/504, RunningAvgSamplesPerSec=7.06400085284381, CurrSamplesPerSec=4.6106478018290655, MemAllocated=4.77GB, MaxMemAllocated=14.95GB
[2022-11-23 23:37:54,508] [INFO] [timer.py:198:stop] 0/506, RunningAvgSamplesPerSec=7.0523684616262665, CurrSamplesPerSec=4.619638760299539, MemAllocated=4.77GB, MaxMemAllocated=14.95GB
[2022-11-23 23:38:10,323] [INFO] [logging.py:68:log_dist] [Rank 0] step=254, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:38:10,323] [INFO] [timer.py:198:stop] 0/508, RunningAvgSamplesPerSec=7.040903674067479, CurrSamplesPerSec=4.620017855284079, MemAllocated=4.77GB, MaxMemAllocated=14.95GB
[2022-11-23 23:38:26,141] [INFO] [timer.py:198:stop] 0/510, RunningAvgSamplesPerSec=7.0292810155910965, CurrSamplesPerSec=4.588991703980065, MemAllocated=4.77GB, MaxMemAllocated=15.06GB
***** Evaluating perplexity, Epoch 1/2 *****
'step':510, 'ppl': 34.192534700035075, 'seq_len': 696, 'consume layer-tokens': 11328704
[2022-11-23 23:38:49,441] [INFO] [logging.py:68:log_dist] [Rank 0] step=256, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:38:49,442] [INFO] [timer.py:198:stop] 0/512, RunningAvgSamplesPerSec=7.017770936092305, CurrSamplesPerSec=4.588524815238837, MemAllocated=4.77GB, MaxMemAllocated=15.07GB
[2022-11-23 23:39:05,249] [INFO] [timer.py:198:stop] 0/514, RunningAvgSamplesPerSec=7.006369479451854, CurrSamplesPerSec=4.591051163961656, MemAllocated=4.77GB, MaxMemAllocated=15.07GB
[2022-11-23 23:39:21,055] [INFO] [logging.py:68:log_dist] [Rank 0] step=258, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:39:21,056] [INFO] [timer.py:198:stop] 0/516, RunningAvgSamplesPerSec=6.99506940709189, CurrSamplesPerSec=4.580424635962355, MemAllocated=4.77GB, MaxMemAllocated=15.07GB
[2022-11-23 23:39:36,873] [INFO] [timer.py:198:stop] 0/518, RunningAvgSamplesPerSec=6.983697415065424, CurrSamplesPerSec=4.560414039055365, MemAllocated=4.78GB, MaxMemAllocated=15.17GB
[2022-11-23 23:39:52,692] [INFO] [logging.py:68:log_dist] [Rank 0] step=260, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:39:52,693] [INFO] [timer.py:198:stop] 0/520, RunningAvgSamplesPerSec=6.972474676101571, CurrSamplesPerSec=4.557767746730794, MemAllocated=4.78GB, MaxMemAllocated=15.18GB
***** Evaluating perplexity, Epoch 1/2 *****
'step':520, 'ppl': 33.52863498659426, 'seq_len': 704, 'consume layer-tokens': 11678016
[2022-11-23 23:40:15,995] [INFO] [timer.py:198:stop] 0/522, RunningAvgSamplesPerSec=6.961411136450858, CurrSamplesPerSec=4.5696828854682305, MemAllocated=4.78GB, MaxMemAllocated=15.18GB
[2022-11-23 23:40:31,819] [INFO] [logging.py:68:log_dist] [Rank 0] step=262, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:40:31,819] [INFO] [timer.py:198:stop] 0/524, RunningAvgSamplesPerSec=6.949779130321926, CurrSamplesPerSec=4.487064785459712, MemAllocated=4.78GB, MaxMemAllocated=15.3GB
***** Evaluating perplexity, Epoch 1/2 *****
'step':523, 'ppl': 33.085292722578544, 'seq_len': 712, 'consume layer-tokens': 11748864
[2022-11-23 23:40:55,139] [INFO] [timer.py:198:stop] 0/526, RunningAvgSamplesPerSec=6.93831278940827, CurrSamplesPerSec=4.496753384247816, MemAllocated=4.78GB, MaxMemAllocated=15.3GB
[2022-11-23 23:41:10,968] [INFO] [logging.py:68:log_dist] [Rank 0] step=264, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:41:10,968] [INFO] [timer.py:198:stop] 0/528, RunningAvgSamplesPerSec=6.926926012835741, CurrSamplesPerSec=4.493210323564827, MemAllocated=4.78GB, MaxMemAllocated=15.3GB
[2022-11-23 23:41:26,794] [INFO] [timer.py:198:stop] 0/530, RunningAvgSamplesPerSec=6.915686848277903, CurrSamplesPerSec=4.496666607701779, MemAllocated=4.78GB, MaxMemAllocated=15.3GB
***** Evaluating perplexity, Epoch 2/2 *****
'step':530, 'ppl': 32.32675524684356, 'seq_len': 720, 'consume layer-tokens': 12032960
[2022-11-23 23:41:50,118] [INFO] [logging.py:68:log_dist] [Rank 0] step=266, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:41:50,119] [INFO] [timer.py:198:stop] 0/532, RunningAvgSamplesPerSec=6.904388746912372, CurrSamplesPerSec=4.472102034157815, MemAllocated=4.78GB, MaxMemAllocated=15.42GB
[2022-11-23 23:42:05,944] [INFO] [timer.py:198:stop] 0/534, RunningAvgSamplesPerSec=6.8931998326833295, CurrSamplesPerSec=4.473685670097595, MemAllocated=4.78GB, MaxMemAllocated=15.42GB
[2022-11-23 23:42:21,769] [INFO] [logging.py:68:log_dist] [Rank 0] step=268, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:42:21,770] [INFO] [timer.py:198:stop] 0/536, RunningAvgSamplesPerSec=6.882147036045603, CurrSamplesPerSec=4.474532803127892, MemAllocated=4.78GB, MaxMemAllocated=15.42GB
[2022-11-23 23:42:37,609] [INFO] [timer.py:198:stop] 0/538, RunningAvgSamplesPerSec=6.87088650878321, CurrSamplesPerSec=4.431153590569532, MemAllocated=4.79GB, MaxMemAllocated=15.52GB
[2022-11-23 23:42:53,453] [INFO] [logging.py:68:log_dist] [Rank 0] step=270, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:42:53,454] [INFO] [timer.py:198:stop] 0/540, RunningAvgSamplesPerSec=6.859798862709475, CurrSamplesPerSec=4.446239018378894, MemAllocated=4.79GB, MaxMemAllocated=15.52GB
***** Evaluating perplexity, Epoch 2/2 *****
'step':540, 'ppl': 31.5899538261805, 'seq_len': 728, 'consume layer-tokens': 12392832
[2022-11-23 23:43:16,815] [INFO] [timer.py:198:stop] 0/542, RunningAvgSamplesPerSec=6.848788977976743, CurrSamplesPerSec=4.433675947571406, MemAllocated=4.79GB, MaxMemAllocated=15.52GB
[2022-11-23 23:43:32,673] [INFO] [logging.py:68:log_dist] [Rank 0] step=272, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:43:32,674] [INFO] [timer.py:198:stop] 0/544, RunningAvgSamplesPerSec=6.837880629255942, CurrSamplesPerSec=4.436506181993575, MemAllocated=4.79GB, MaxMemAllocated=15.52GB
[2022-11-23 23:43:48,529] [INFO] [timer.py:198:stop] 0/546, RunningAvgSamplesPerSec=6.826918718456151, CurrSamplesPerSec=4.418268225483891, MemAllocated=4.79GB, MaxMemAllocated=15.63GB
[2022-11-23 23:44:04,390] [INFO] [logging.py:68:log_dist] [Rank 0] step=274, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:44:04,390] [INFO] [timer.py:198:stop] 0/548, RunningAvgSamplesPerSec=6.816008313036651, CurrSamplesPerSec=4.406448034156427, MemAllocated=4.79GB, MaxMemAllocated=15.63GB
[2022-11-23 23:44:20,236] [INFO] [timer.py:198:stop] 0/550, RunningAvgSamplesPerSec=6.805262495586456, CurrSamplesPerSec=4.413075603426462, MemAllocated=4.79GB, MaxMemAllocated=15.63GB
***** Evaluating perplexity, Epoch 2/2 *****
'step':550, 'ppl': 30.902702422028277, 'seq_len': 744, 'consume layer-tokens': 12757632
[2022-11-23 23:44:43,592] [INFO] [logging.py:68:log_dist] [Rank 0] step=276, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:44:43,592] [INFO] [timer.py:198:stop] 0/552, RunningAvgSamplesPerSec=6.794262986371768, CurrSamplesPerSec=4.374993415559307, MemAllocated=4.8GB, MaxMemAllocated=15.74GB
[2022-11-23 23:44:59,430] [INFO] [timer.py:198:stop] 0/554, RunningAvgSamplesPerSec=6.7833313664090005, CurrSamplesPerSec=4.368152084823906, MemAllocated=4.8GB, MaxMemAllocated=15.74GB
[2022-11-23 23:45:15,286] [INFO] [logging.py:68:log_dist] [Rank 0] step=278, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:45:15,287] [INFO] [timer.py:198:stop] 0/556, RunningAvgSamplesPerSec=6.772592522251477, CurrSamplesPerSec=4.381117020304285, MemAllocated=4.8GB, MaxMemAllocated=15.75GB
[2022-11-23 23:45:31,130] [INFO] [timer.py:198:stop] 0/558, RunningAvgSamplesPerSec=6.761966714930874, CurrSamplesPerSec=4.382517800729008, MemAllocated=4.8GB, MaxMemAllocated=15.75GB
[2022-11-23 23:45:46,989] [INFO] [logging.py:68:log_dist] [Rank 0] step=280, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:45:46,990] [INFO] [timer.py:198:stop] 0/560, RunningAvgSamplesPerSec=6.751197563512896, CurrSamplesPerSec=4.349829996613932, MemAllocated=4.8GB, MaxMemAllocated=15.86GB
***** Evaluating perplexity, Epoch 2/2 *****
'step':560, 'ppl': 29.980668802769824, 'seq_len': 752, 'consume layer-tokens': 13127360
[2022-11-23 23:46:10,347] [INFO] [timer.py:198:stop] 0/562, RunningAvgSamplesPerSec=6.740567003876832, CurrSamplesPerSec=4.342608420156774, MemAllocated=4.8GB, MaxMemAllocated=15.86GB
[2022-11-23 23:46:26,191] [INFO] [logging.py:68:log_dist] [Rank 0] step=282, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:46:26,192] [INFO] [timer.py:198:stop] 0/564, RunningAvgSamplesPerSec=6.730010964381506, CurrSamplesPerSec=4.349843530024864, MemAllocated=4.8GB, MaxMemAllocated=15.86GB
[2022-11-23 23:46:42,050] [INFO] [timer.py:198:stop] 0/566, RunningAvgSamplesPerSec=6.719615189662741, CurrSamplesPerSec=4.35489511215586, MemAllocated=4.8GB, MaxMemAllocated=15.86GB
[2022-11-23 23:46:57,900] [INFO] [logging.py:68:log_dist] [Rank 0] step=284, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:46:57,901] [INFO] [timer.py:198:stop] 0/568, RunningAvgSamplesPerSec=6.70919408047151, CurrSamplesPerSec=4.336157041454131, MemAllocated=4.8GB, MaxMemAllocated=15.98GB
[2022-11-23 23:47:13,757] [INFO] [timer.py:198:stop] 0/570, RunningAvgSamplesPerSec=6.698953139625993, CurrSamplesPerSec=4.353107539598317, MemAllocated=4.8GB, MaxMemAllocated=15.99GB
***** Evaluating perplexity, Epoch 2/2 *****
'step':570, 'ppl': 29.80890076120859, 'seq_len': 760, 'consume layer-tokens': 13501312
[2022-11-23 23:47:37,109] [INFO] [logging.py:68:log_dist] [Rank 0] step=286, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:47:37,109] [INFO] [timer.py:198:stop] 0/572, RunningAvgSamplesPerSec=6.688774223030729, CurrSamplesPerSec=4.339883212418989, MemAllocated=4.8GB, MaxMemAllocated=15.99GB
[2022-11-23 23:47:52,964] [INFO] [timer.py:198:stop] 0/574, RunningAvgSamplesPerSec=6.6785414856760905, CurrSamplesPerSec=4.319947513455085, MemAllocated=4.81GB, MaxMemAllocated=16.1GB
[2022-11-23 23:48:08,829] [INFO] [logging.py:68:log_dist] [Rank 0] step=288, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:48:08,830] [INFO] [timer.py:198:stop] 0/576, RunningAvgSamplesPerSec=6.6684481450666775, CurrSamplesPerSec=4.332663268826712, MemAllocated=4.81GB, MaxMemAllocated=16.1GB
[2022-11-23 23:48:24,685] [INFO] [timer.py:198:stop] 0/578, RunningAvgSamplesPerSec=6.658450381910331, CurrSamplesPerSec=4.3337220037206965, MemAllocated=4.81GB, MaxMemAllocated=16.1GB
[2022-11-23 23:48:40,537] [INFO] [logging.py:68:log_dist] [Rank 0] step=290, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:48:40,538] [INFO] [timer.py:198:stop] 0/580, RunningAvgSamplesPerSec=6.648528785674762, CurrSamplesPerSec=4.324985602471477, MemAllocated=4.81GB, MaxMemAllocated=16.1GB
***** Evaluating perplexity, Epoch 2/2 *****
'step':580, 'ppl': 29.482679940161475, 'seq_len': 776, 'consume layer-tokens': 13880896
[2022-11-23 23:49:03,907] [INFO] [timer.py:198:stop] 0/582, RunningAvgSamplesPerSec=6.637855586688717, CurrSamplesPerSec=4.215133080115391, MemAllocated=4.81GB, MaxMemAllocated=16.23GB
[2022-11-23 23:49:19,788] [INFO] [logging.py:68:log_dist] [Rank 0] step=292, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:49:19,789] [INFO] [timer.py:198:stop] 0/584, RunningAvgSamplesPerSec=6.627275678863499, CurrSamplesPerSec=4.219715124479616, MemAllocated=4.81GB, MaxMemAllocated=16.23GB
[2022-11-23 23:49:35,676] [INFO] [timer.py:198:stop] 0/586, RunningAvgSamplesPerSec=6.616745582666478, CurrSamplesPerSec=4.216067339607052, MemAllocated=4.81GB, MaxMemAllocated=16.23GB
[2022-11-23 23:49:51,576] [INFO] [logging.py:68:log_dist] [Rank 0] step=294, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:49:51,576] [INFO] [timer.py:198:stop] 0/588, RunningAvgSamplesPerSec=6.6061044654017795, CurrSamplesPerSec=4.189919249505393, MemAllocated=4.82GB, MaxMemAllocated=16.34GB
[2022-11-23 23:50:07,459] [INFO] [timer.py:198:stop] 0/590, RunningAvgSamplesPerSec=6.595660639367275, CurrSamplesPerSec=4.194132040586336, MemAllocated=4.82GB, MaxMemAllocated=16.34GB
***** Evaluating perplexity, Epoch 2/2 *****
'step':590, 'ppl': 28.836594465108263, 'seq_len': 784, 'consume layer-tokens': 14265408
[2022-11-23 23:50:30,839] [INFO] [logging.py:68:log_dist] [Rank 0] step=296, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:50:30,839] [INFO] [timer.py:198:stop] 0/592, RunningAvgSamplesPerSec=6.585277705819623, CurrSamplesPerSec=4.198441564161481, MemAllocated=4.82GB, MaxMemAllocated=16.34GB
[2022-11-23 23:50:46,731] [INFO] [timer.py:198:stop] 0/594, RunningAvgSamplesPerSec=6.575011408032657, CurrSamplesPerSec=4.1982776698144795, MemAllocated=4.82GB, MaxMemAllocated=16.35GB
[2022-11-23 23:51:02,622] [INFO] [logging.py:68:log_dist] [Rank 0] step=298, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:51:02,623] [INFO] [timer.py:198:stop] 0/596, RunningAvgSamplesPerSec=6.564560308417717, CurrSamplesPerSec=4.163306104399692, MemAllocated=4.82GB, MaxMemAllocated=16.46GB
[2022-11-23 23:51:18,511] [INFO] [timer.py:198:stop] 0/598, RunningAvgSamplesPerSec=6.554168068564993, CurrSamplesPerSec=4.155382608794724, MemAllocated=4.82GB, MaxMemAllocated=16.46GB
[2022-11-23 23:51:34,393] [INFO] [logging.py:68:log_dist] [Rank 0] step=300, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:51:34,393] [INFO] [timer.py:198:stop] 0/600, RunningAvgSamplesPerSec=6.543898327052374, CurrSamplesPerSec=4.153783838653931, MemAllocated=4.82GB, MaxMemAllocated=16.46GB
***** Evaluating perplexity, Epoch 2/2 *****
'step':600, 'ppl': 28.074216697383623, 'seq_len': 800, 'consume layer-tokens': 14654848
[2022-11-23 23:51:57,762] [INFO] [timer.py:198:stop] 0/602, RunningAvgSamplesPerSec=6.533801950530849, CurrSamplesPerSec=4.163390823138199, MemAllocated=4.82GB, MaxMemAllocated=16.58GB
[2022-11-23 23:52:13,626] [INFO] [logging.py:68:log_dist] [Rank 0] step=302, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:52:13,626] [INFO] [timer.py:198:stop] 0/604, RunningAvgSamplesPerSec=6.52387051817771, CurrSamplesPerSec=4.173117084561681, MemAllocated=4.82GB, MaxMemAllocated=16.59GB
[2022-11-23 23:52:29,498] [INFO] [timer.py:198:stop] 0/606, RunningAvgSamplesPerSec=6.514039327173608, CurrSamplesPerSec=4.180641663045169, MemAllocated=4.82GB, MaxMemAllocated=16.59GB
[2022-11-23 23:52:45,361] [INFO] [logging.py:68:log_dist] [Rank 0] step=304, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:52:45,362] [INFO] [timer.py:198:stop] 0/608, RunningAvgSamplesPerSec=6.504297553676515, CurrSamplesPerSec=4.178409330905237, MemAllocated=4.83GB, MaxMemAllocated=16.59GB
[2022-11-23 23:53:01,252] [INFO] [timer.py:198:stop] 0/610, RunningAvgSamplesPerSec=6.4938400001591035, CurrSamplesPerSec=4.077745716441243, MemAllocated=4.83GB, MaxMemAllocated=16.7GB
***** Evaluating perplexity, Epoch 2/2 *****
'step':610, 'ppl': 27.371416179892453, 'seq_len': 808, 'consume layer-tokens': 15049216
[2022-11-23 23:53:24,651] [INFO] [logging.py:68:log_dist] [Rank 0] step=306, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:53:24,652] [INFO] [timer.py:198:stop] 0/612, RunningAvgSamplesPerSec=6.483462742043157, CurrSamplesPerSec=4.0764200468744605, MemAllocated=4.83GB, MaxMemAllocated=16.71GB
[2022-11-23 23:53:40,549] [INFO] [timer.py:198:stop] 0/614, RunningAvgSamplesPerSec=6.4732537131266765, CurrSamplesPerSec=4.085393536409624, MemAllocated=4.83GB, MaxMemAllocated=16.71GB
[2022-11-23 23:53:56,443] [INFO] [logging.py:68:log_dist] [Rank 0] step=308, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:53:56,444] [INFO] [timer.py:198:stop] 0/616, RunningAvgSamplesPerSec=6.46307951065933, CurrSamplesPerSec=4.082168862433386, MemAllocated=4.83GB, MaxMemAllocated=16.71GB
[2022-11-23 23:54:12,347] [INFO] [timer.py:198:stop] 0/618, RunningAvgSamplesPerSec=6.452877576665118, CurrSamplesPerSec=4.042318873822581, MemAllocated=4.83GB, MaxMemAllocated=16.83GB
[2022-11-23 23:54:28,253] [INFO] [logging.py:68:log_dist] [Rank 0] step=310, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:54:28,254] [INFO] [timer.py:198:stop] 0/620, RunningAvgSamplesPerSec=6.442929923670858, CurrSamplesPerSec=4.078158058494088, MemAllocated=4.83GB, MaxMemAllocated=16.83GB
***** Evaluating perplexity, Epoch 2/2 *****
'step':620, 'ppl': 26.942995648054705, 'seq_len': 816, 'consume layer-tokens': 15447808
[2022-11-23 23:54:51,644] [INFO] [timer.py:198:stop] 0/622, RunningAvgSamplesPerSec=6.433143816177247, CurrSamplesPerSec=4.07890960774217, MemAllocated=4.83GB, MaxMemAllocated=16.83GB
[2022-11-23 23:55:07,562] [INFO] [logging.py:68:log_dist] [Rank 0] step=312, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:55:07,563] [INFO] [timer.py:198:stop] 0/624, RunningAvgSamplesPerSec=6.423120458640158, CurrSamplesPerSec=4.019673312607098, MemAllocated=4.84GB, MaxMemAllocated=16.95GB
[2022-11-23 23:55:23,471] [INFO] [timer.py:198:stop] 0/626, RunningAvgSamplesPerSec=6.413461427401412, CurrSamplesPerSec=4.084844465285965, MemAllocated=4.84GB, MaxMemAllocated=16.95GB
[2022-11-23 23:55:39,373] [INFO] [logging.py:68:log_dist] [Rank 0] step=314, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:55:39,374] [INFO] [timer.py:198:stop] 0/628, RunningAvgSamplesPerSec=6.403871587350053, CurrSamplesPerSec=4.0819443984872406, MemAllocated=4.84GB, MaxMemAllocated=16.95GB
[2022-11-23 23:55:55,271] [INFO] [timer.py:198:stop] 0/630, RunningAvgSamplesPerSec=6.39441696997956, CurrSamplesPerSec=4.082232431930009, MemAllocated=4.84GB, MaxMemAllocated=16.95GB
***** Evaluating perplexity, Epoch 2/2 *****
'step':630, 'ppl': 26.550607892066687, 'seq_len': 832, 'consume layer-tokens': 15852032
[2022-11-23 23:56:18,660] [INFO] [logging.py:68:log_dist] [Rank 0] step=316, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:56:18,661] [INFO] [timer.py:198:stop] 0/632, RunningAvgSamplesPerSec=6.385094281792297, CurrSamplesPerSec=4.090132417459718, MemAllocated=4.84GB, MaxMemAllocated=17.07GB
[2022-11-23 23:56:34,559] [INFO] [timer.py:198:stop] 0/634, RunningAvgSamplesPerSec=6.375802400423825, CurrSamplesPerSec=4.086165668661702, MemAllocated=4.84GB, MaxMemAllocated=17.08GB
[2022-11-23 23:56:50,467] [INFO] [logging.py:68:log_dist] [Rank 0] step=318, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:56:50,467] [INFO] [timer.py:198:stop] 0/636, RunningAvgSamplesPerSec=6.366666368746663, CurrSamplesPerSec=4.091315363999717, MemAllocated=4.84GB, MaxMemAllocated=17.08GB
[2022-11-23 23:57:06,394] [INFO] [timer.py:198:stop] 0/638, RunningAvgSamplesPerSec=6.3564497542648715, CurrSamplesPerSec=3.93856878990282, MemAllocated=4.84GB, MaxMemAllocated=17.2GB
[2022-11-23 23:57:22,335] [INFO] [logging.py:68:log_dist] [Rank 0] step=320, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:57:22,336] [INFO] [timer.py:198:stop] 0/640, RunningAvgSamplesPerSec=6.346350348904062, CurrSamplesPerSec=3.944456225963155, MemAllocated=4.84GB, MaxMemAllocated=17.2GB
***** Evaluating perplexity, Epoch 2/2 *****
'step':640, 'ppl': 25.836802958394646, 'seq_len': 840, 'consume layer-tokens': 16261184
[2022-11-23 23:57:45,754] [INFO] [timer.py:198:stop] 0/642, RunningAvgSamplesPerSec=6.3363324433720685, CurrSamplesPerSec=3.9445025951516417, MemAllocated=4.85GB, MaxMemAllocated=17.2GB
[2022-11-23 23:58:01,699] [INFO] [logging.py:68:log_dist] [Rank 0] step=322, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:58:01,700] [INFO] [timer.py:198:stop] 0/644, RunningAvgSamplesPerSec=6.326440885515311, CurrSamplesPerSec=3.9459350125077264, MemAllocated=4.84GB, MaxMemAllocated=17.2GB
[2022-11-23 23:58:17,640] [INFO] [timer.py:198:stop] 0/646, RunningAvgSamplesPerSec=6.3164601759465056, CurrSamplesPerSec=3.926058046969811, MemAllocated=4.85GB, MaxMemAllocated=17.33GB
[2022-11-23 23:58:33,591] [INFO] [logging.py:68:log_dist] [Rank 0] step=324, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:58:33,591] [INFO] [timer.py:198:stop] 0/648, RunningAvgSamplesPerSec=6.306602971549809, CurrSamplesPerSec=3.936458120210004, MemAllocated=4.85GB, MaxMemAllocated=17.33GB
[2022-11-23 23:58:49,538] [INFO] [timer.py:198:stop] 0/650, RunningAvgSamplesPerSec=6.296819469030442, CurrSamplesPerSec=3.9232193509011104, MemAllocated=4.85GB, MaxMemAllocated=17.33GB
***** Evaluating perplexity, Epoch 2/2 *****
'step':650, 'ppl': 25.327910377707106, 'seq_len': 856, 'consume layer-tokens': 16675264
[2022-11-23 23:59:12,972] [INFO] [logging.py:68:log_dist] [Rank 0] step=326, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:59:12,973] [INFO] [timer.py:198:stop] 0/652, RunningAvgSamplesPerSec=6.286989299638795, CurrSamplesPerSec=3.9074575418526005, MemAllocated=4.85GB, MaxMemAllocated=17.46GB
[2022-11-23 23:59:28,928] [INFO] [timer.py:198:stop] 0/654, RunningAvgSamplesPerSec=6.277212929249423, CurrSamplesPerSec=3.9022280814458967, MemAllocated=4.85GB, MaxMemAllocated=17.46GB
[2022-11-23 23:59:44,878] [INFO] [logging.py:68:log_dist] [Rank 0] step=328, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-23 23:59:44,879] [INFO] [timer.py:198:stop] 0/656, RunningAvgSamplesPerSec=6.267584839374842, CurrSamplesPerSec=3.917268869636035, MemAllocated=4.85GB, MaxMemAllocated=17.46GB
[2022-11-24 00:00:00,846] [INFO] [timer.py:198:stop] 0/658, RunningAvgSamplesPerSec=6.2580308223225725, CurrSamplesPerSec=3.9088231045585653, MemAllocated=4.85GB, MaxMemAllocated=17.46GB
[2022-11-24 00:00:16,791] [INFO] [logging.py:68:log_dist] [Rank 0] step=330, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-24 00:00:16,792] [INFO] [timer.py:198:stop] 0/660, RunningAvgSamplesPerSec=6.248478551439889, CurrSamplesPerSec=3.9081766192622616, MemAllocated=4.86GB, MaxMemAllocated=17.58GB
***** Evaluating perplexity, Epoch 2/2 *****
'step':660, 'ppl': 25.148566407685678, 'seq_len': 864, 'consume layer-tokens': 17094272
[2022-11-24 00:00:40,233] [INFO] [timer.py:198:stop] 0/662, RunningAvgSamplesPerSec=6.239015128155624, CurrSamplesPerSec=3.9067569235354798, MemAllocated=4.86GB, MaxMemAllocated=17.58GB
[2022-11-24 00:00:56,184] [INFO] [logging.py:68:log_dist] [Rank 0] step=332, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-24 00:00:56,185] [INFO] [timer.py:198:stop] 0/664, RunningAvgSamplesPerSec=6.229619714878003, CurrSamplesPerSec=3.896884065881741, MemAllocated=4.86GB, MaxMemAllocated=17.58GB
[2022-11-24 00:01:12,139] [INFO] [timer.py:198:stop] 0/666, RunningAvgSamplesPerSec=6.220347065021035, CurrSamplesPerSec=3.9053709856808787, MemAllocated=4.86GB, MaxMemAllocated=17.58GB
[2022-11-24 00:01:28,096] [INFO] [logging.py:68:log_dist] [Rank 0] step=334, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-24 00:01:28,096] [INFO] [timer.py:198:stop] 0/668, RunningAvgSamplesPerSec=6.210918081016054, CurrSamplesPerSec=3.870939280771806, MemAllocated=4.86GB, MaxMemAllocated=17.71GB
[2022-11-24 00:01:44,054] [INFO] [timer.py:198:stop] 0/670, RunningAvgSamplesPerSec=6.201595560370464, CurrSamplesPerSec=3.870680291507361, MemAllocated=4.86GB, MaxMemAllocated=17.72GB
***** Evaluating perplexity, Epoch 2/2 *****
'step':670, 'ppl': 24.748976008053607, 'seq_len': 872, 'consume layer-tokens': 17517504
[2022-11-24 00:02:07,509] [INFO] [logging.py:68:log_dist] [Rank 0] step=336, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-24 00:02:07,510] [INFO] [timer.py:198:stop] 0/672, RunningAvgSamplesPerSec=6.192320893564454, CurrSamplesPerSec=3.8693109039038553, MemAllocated=4.86GB, MaxMemAllocated=17.72GB
[2022-11-24 00:02:23,502] [INFO] [timer.py:198:stop] 0/674, RunningAvgSamplesPerSec=6.183017032758283, CurrSamplesPerSec=3.8532809310410086, MemAllocated=4.86GB, MaxMemAllocated=17.84GB
[2022-11-24 00:02:39,474] [INFO] [logging.py:68:log_dist] [Rank 0] step=338, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-24 00:02:39,475] [INFO] [timer.py:198:stop] 0/676, RunningAvgSamplesPerSec=6.173783981872742, CurrSamplesPerSec=3.8546336801088117, MemAllocated=4.86GB, MaxMemAllocated=17.84GB
[2022-11-24 00:02:55,453] [INFO] [timer.py:198:stop] 0/678, RunningAvgSamplesPerSec=6.164671107841153, CurrSamplesPerSec=3.8559448402666052, MemAllocated=4.86GB, MaxMemAllocated=17.84GB
[2022-11-24 00:03:11,430] [INFO] [logging.py:68:log_dist] [Rank 0] step=340, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-24 00:03:11,431] [INFO] [timer.py:198:stop] 0/680, RunningAvgSamplesPerSec=6.155605457758922, CurrSamplesPerSec=3.8550605951565236, MemAllocated=4.86GB, MaxMemAllocated=17.84GB
***** Evaluating perplexity, Epoch 2/2 *****
'step':680, 'ppl': 24.26671844415462, 'seq_len': 888, 'consume layer-tokens': 17946368
[2022-11-24 00:03:34,893] [INFO] [timer.py:198:stop] 0/682, RunningAvgSamplesPerSec=6.146469398720535, CurrSamplesPerSec=3.8293182728050006, MemAllocated=4.87GB, MaxMemAllocated=17.98GB
[2022-11-24 00:03:50,871] [INFO] [logging.py:68:log_dist] [Rank 0] step=342, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-24 00:03:50,872] [INFO] [timer.py:198:stop] 0/684, RunningAvgSamplesPerSec=6.137378046547939, CurrSamplesPerSec=3.833411324286383, MemAllocated=4.87GB, MaxMemAllocated=17.98GB
[2022-11-24 00:04:06,844] [INFO] [timer.py:198:stop] 0/686, RunningAvgSamplesPerSec=6.128355876232746, CurrSamplesPerSec=3.8278190359505087, MemAllocated=4.87GB, MaxMemAllocated=17.98GB
[2022-11-24 00:04:22,840] [INFO] [logging.py:68:log_dist] [Rank 0] step=344, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-24 00:04:22,840] [INFO] [timer.py:198:stop] 0/688, RunningAvgSamplesPerSec=6.119311797778945, CurrSamplesPerSec=3.8113786031228503, MemAllocated=4.87GB, MaxMemAllocated=18.11GB
[2022-11-24 00:04:38,821] [INFO] [timer.py:198:stop] 0/690, RunningAvgSamplesPerSec=6.110357935341098, CurrSamplesPerSec=3.8154611401980274, MemAllocated=4.87GB, MaxMemAllocated=18.11GB
***** Evaluating perplexity, Epoch 2/2 *****
'step':690, 'ppl': 23.964281870154263, 'seq_len': 896, 'consume layer-tokens': 18380160
[2022-11-24 00:05:02,277] [INFO] [logging.py:68:log_dist] [Rank 0] step=346, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-24 00:05:02,278] [INFO] [timer.py:198:stop] 0/692, RunningAvgSamplesPerSec=6.101527338661585, CurrSamplesPerSec=3.8219034597382904, MemAllocated=4.87GB, MaxMemAllocated=18.11GB
[2022-11-24 00:05:18,264] [INFO] [timer.py:198:stop] 0/694, RunningAvgSamplesPerSec=6.092728045401802, CurrSamplesPerSec=3.813738647812124, MemAllocated=4.87GB, MaxMemAllocated=18.11GB
[2022-11-24 00:05:34,271] [INFO] [logging.py:68:log_dist] [Rank 0] step=348, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-24 00:05:34,272] [INFO] [timer.py:198:stop] 0/696, RunningAvgSamplesPerSec=6.083597718928855, CurrSamplesPerSec=3.7570643635041177, MemAllocated=4.88GB, MaxMemAllocated=18.24GB
[2022-11-24 00:05:50,254] [INFO] [timer.py:198:stop] 0/698, RunningAvgSamplesPerSec=6.0746347492200625, CurrSamplesPerSec=3.776221522272375, MemAllocated=4.88GB, MaxMemAllocated=18.24GB
[2022-11-24 00:06:06,227] [INFO] [logging.py:68:log_dist] [Rank 0] step=350, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-24 00:06:06,228] [INFO] [timer.py:198:stop] 0/700, RunningAvgSamplesPerSec=6.065697290500935, CurrSamplesPerSec=3.7684790563132946, MemAllocated=4.88GB, MaxMemAllocated=18.24GB
***** Evaluating perplexity, Epoch 2/2 *****
'step':700, 'ppl': 23.597171875467815, 'seq_len': 912, 'consume layer-tokens': 18818880
[2022-11-24 00:06:29,713] [INFO] [timer.py:198:stop] 0/702, RunningAvgSamplesPerSec=6.056778688015799, CurrSamplesPerSec=3.755200853767284, MemAllocated=4.88GB, MaxMemAllocated=18.36GB
[2022-11-24 00:06:45,700] [INFO] [logging.py:68:log_dist] [Rank 0] step=352, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-24 00:06:45,701] [INFO] [timer.py:198:stop] 0/704, RunningAvgSamplesPerSec=6.047920992515369, CurrSamplesPerSec=3.7535726383134667, MemAllocated=4.88GB, MaxMemAllocated=18.37GB
[2022-11-24 00:07:01,688] [INFO] [timer.py:198:stop] 0/706, RunningAvgSamplesPerSec=6.03909627367459, CurrSamplesPerSec=3.748319567106724, MemAllocated=4.88GB, MaxMemAllocated=18.37GB
[2022-11-24 00:07:17,674] [INFO] [logging.py:68:log_dist] [Rank 0] step=354, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-24 00:07:17,675] [INFO] [timer.py:198:stop] 0/708, RunningAvgSamplesPerSec=6.030386594498013, CurrSamplesPerSec=3.757049219241613, MemAllocated=4.88GB, MaxMemAllocated=18.37GB
[2022-11-24 00:07:33,666] [INFO] [timer.py:198:stop] 0/710, RunningAvgSamplesPerSec=6.021630140568098, CurrSamplesPerSec=3.7301236792326145, MemAllocated=4.88GB, MaxMemAllocated=18.5GB
***** Evaluating perplexity, Epoch 2/2 *****
'step':710, 'ppl': 23.153611462160917, 'seq_len': 920, 'consume layer-tokens': 19262528
[2022-11-24 00:07:57,151] [INFO] [logging.py:68:log_dist] [Rank 0] step=356, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-24 00:07:57,151] [INFO] [timer.py:198:stop] 0/712, RunningAvgSamplesPerSec=6.012960660456431, CurrSamplesPerSec=3.7410613265712502, MemAllocated=4.88GB, MaxMemAllocated=18.5GB
[2022-11-24 00:08:13,138] [INFO] [timer.py:198:stop] 0/714, RunningAvgSamplesPerSec=6.004372486531422, CurrSamplesPerSec=3.744287451877476, MemAllocated=4.88GB, MaxMemAllocated=18.5GB
[2022-11-24 00:08:29,126] [INFO] [logging.py:68:log_dist] [Rank 0] step=358, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-24 00:08:29,127] [INFO] [timer.py:198:stop] 0/716, RunningAvgSamplesPerSec=5.9958377088580725, CurrSamplesPerSec=3.741763854183487, MemAllocated=4.89GB, MaxMemAllocated=18.5GB
[2022-11-24 00:08:45,121] [INFO] [timer.py:198:stop] 0/718, RunningAvgSamplesPerSec=5.987256193897054, CurrSamplesPerSec=3.7261454912598726, MemAllocated=4.89GB, MaxMemAllocated=18.64GB
[2022-11-24 00:09:01,117] [INFO] [logging.py:68:log_dist] [Rank 0] step=360, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-24 00:09:01,118] [INFO] [timer.py:198:stop] 0/720, RunningAvgSamplesPerSec=5.978739316170488, CurrSamplesPerSec=3.722393803204896, MemAllocated=4.89GB, MaxMemAllocated=18.64GB
***** Evaluating perplexity, Epoch 2/2 *****
'step':720, 'ppl': 22.798896870933707, 'seq_len': 928, 'consume layer-tokens': 19710400
[2022-11-24 00:09:24,620] [INFO] [timer.py:198:stop] 0/722, RunningAvgSamplesPerSec=5.970302324496328, CurrSamplesPerSec=3.722785318519603, MemAllocated=4.89GB, MaxMemAllocated=18.64GB
[2022-11-24 00:09:40,626] [INFO] [logging.py:68:log_dist] [Rank 0] step=362, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-24 00:09:40,627] [INFO] [timer.py:198:stop] 0/724, RunningAvgSamplesPerSec=5.961763236905701, CurrSamplesPerSec=3.69603097602865, MemAllocated=4.89GB, MaxMemAllocated=18.76GB
[2022-11-24 00:09:56,638] [INFO] [timer.py:198:stop] 0/726, RunningAvgSamplesPerSec=5.953268170820156, CurrSamplesPerSec=3.6969643282902602, MemAllocated=4.89GB, MaxMemAllocated=18.76GB
[2022-11-24 00:10:12,656] [INFO] [logging.py:68:log_dist] [Rank 0] step=364, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-24 00:10:12,656] [INFO] [timer.py:198:stop] 0/728, RunningAvgSamplesPerSec=5.944880642067124, CurrSamplesPerSec=3.6984084505241457, MemAllocated=4.89GB, MaxMemAllocated=18.76GB
[2022-11-24 00:10:28,670] [INFO] [timer.py:198:stop] 0/730, RunningAvgSamplesPerSec=5.936514204968792, CurrSamplesPerSec=3.691741668988141, MemAllocated=4.89GB, MaxMemAllocated=18.77GB
***** Evaluating perplexity, Epoch 2/2 *****
'step':730, 'ppl': 22.558086426214988, 'seq_len': 944, 'consume layer-tokens': 20163904
[2022-11-24 00:10:52,200] [INFO] [logging.py:68:log_dist] [Rank 0] step=366, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-24 00:10:52,201] [INFO] [timer.py:198:stop] 0/732, RunningAvgSamplesPerSec=5.927979452934154, CurrSamplesPerSec=3.6559522372344038, MemAllocated=4.9GB, MaxMemAllocated=18.91GB
[2022-11-24 00:11:08,225] [INFO] [timer.py:198:stop] 0/734, RunningAvgSamplesPerSec=5.919509332273377, CurrSamplesPerSec=3.647539632811389, MemAllocated=4.9GB, MaxMemAllocated=18.91GB
[2022-11-24 00:11:24,261] [INFO] [logging.py:68:log_dist] [Rank 0] step=368, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-24 00:11:24,262] [INFO] [timer.py:198:stop] 0/736, RunningAvgSamplesPerSec=5.911136696351307, CurrSamplesPerSec=3.6533235082254794, MemAllocated=4.9GB, MaxMemAllocated=18.91GB
[2022-11-24 00:11:40,304] [INFO] [timer.py:198:stop] 0/738, RunningAvgSamplesPerSec=5.902756485904639, CurrSamplesPerSec=3.646767401966538, MemAllocated=4.9GB, MaxMemAllocated=19.03GB
[2022-11-24 00:11:56,332] [INFO] [logging.py:68:log_dist] [Rank 0] step=370, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-24 00:11:56,332] [INFO] [timer.py:198:stop] 0/740, RunningAvgSamplesPerSec=5.894449699243176, CurrSamplesPerSec=3.6412255126016424, MemAllocated=4.9GB, MaxMemAllocated=19.04GB
***** Evaluating perplexity, Epoch 2/2 *****
'step':740, 'ppl': 22.324723014566583, 'seq_len': 952, 'consume layer-tokens': 20622336
[2022-11-24 00:12:19,862] [INFO] [timer.py:198:stop] 0/742, RunningAvgSamplesPerSec=5.886233655573537, CurrSamplesPerSec=3.6471273128211057, MemAllocated=4.9GB, MaxMemAllocated=19.04GB
[2022-11-24 00:12:35,899] [INFO] [logging.py:68:log_dist] [Rank 0] step=372, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-24 00:12:35,900] [INFO] [timer.py:198:stop] 0/744, RunningAvgSamplesPerSec=5.878041842369535, CurrSamplesPerSec=3.639184600614556, MemAllocated=4.9GB, MaxMemAllocated=19.04GB
[2022-11-24 00:12:51,932] [INFO] [timer.py:198:stop] 0/746, RunningAvgSamplesPerSec=5.8698686047487465, CurrSamplesPerSec=3.6416112050002973, MemAllocated=4.9GB, MaxMemAllocated=19.18GB
[2022-11-24 00:13:07,975] [INFO] [logging.py:68:log_dist] [Rank 0] step=374, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-24 00:13:07,975] [INFO] [timer.py:198:stop] 0/748, RunningAvgSamplesPerSec=5.861732579100513, CurrSamplesPerSec=3.6301873989523936, MemAllocated=4.91GB, MaxMemAllocated=19.18GB
[2022-11-24 00:13:24,030] [INFO] [timer.py:198:stop] 0/750, RunningAvgSamplesPerSec=5.853662448040045, CurrSamplesPerSec=3.6366224867267265, MemAllocated=4.91GB, MaxMemAllocated=19.18GB
***** Evaluating perplexity, Epoch 2/2 *****
'step':750, 'ppl': 22.017673269665032, 'seq_len': 968, 'consume layer-tokens': 21085696
[2022-11-24 00:13:47,629] [INFO] [logging.py:68:log_dist] [Rank 0] step=376, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-24 00:13:47,630] [INFO] [timer.py:198:stop] 0/752, RunningAvgSamplesPerSec=5.844519042079241, CurrSamplesPerSec=3.474524896885994, MemAllocated=4.91GB, MaxMemAllocated=19.32GB
[2022-11-24 00:14:03,704] [INFO] [timer.py:198:stop] 0/754, RunningAvgSamplesPerSec=5.835550546405978, CurrSamplesPerSec=3.494483091018688, MemAllocated=4.91GB, MaxMemAllocated=19.32GB
[2022-11-24 00:14:19,775] [INFO] [logging.py:68:log_dist] [Rank 0] step=378, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-24 00:14:19,776] [INFO] [timer.py:198:stop] 0/756, RunningAvgSamplesPerSec=5.826599713112522, CurrSamplesPerSec=3.486357311593251, MemAllocated=4.91GB, MaxMemAllocated=19.32GB
[2022-11-24 00:14:35,856] [INFO] [timer.py:198:stop] 0/758, RunningAvgSamplesPerSec=5.817700430508836, CurrSamplesPerSec=3.4835876691263463, MemAllocated=4.91GB, MaxMemAllocated=19.32GB
[2022-11-24 00:14:51,929] [INFO] [logging.py:68:log_dist] [Rank 0] step=380, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-24 00:14:51,930] [INFO] [timer.py:198:stop] 0/760, RunningAvgSamplesPerSec=5.808815710459999, CurrSamplesPerSec=3.4720240457903104, MemAllocated=4.91GB, MaxMemAllocated=19.46GB
***** Evaluating perplexity, Epoch 2/2 *****
'step':760, 'ppl': 21.761821367219536, 'seq_len': 976, 'consume layer-tokens': 21553984
[2022-11-24 00:15:15,507] [INFO] [timer.py:198:stop] 0/762, RunningAvgSamplesPerSec=5.80001982599686, CurrSamplesPerSec=3.477239782410537, MemAllocated=4.91GB, MaxMemAllocated=19.46GB
[2022-11-24 00:15:31,613] [INFO] [logging.py:68:log_dist] [Rank 0] step=382, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-24 00:15:31,614] [INFO] [timer.py:198:stop] 0/764, RunningAvgSamplesPerSec=5.7911580708570884, CurrSamplesPerSec=3.4723819111452565, MemAllocated=4.91GB, MaxMemAllocated=19.46GB
[2022-11-24 00:15:47,704] [INFO] [timer.py:198:stop] 0/766, RunningAvgSamplesPerSec=5.782484050935973, CurrSamplesPerSec=3.4757586718824127, MemAllocated=4.91GB, MaxMemAllocated=19.46GB
[2022-11-24 00:16:03,787] [INFO] [logging.py:68:log_dist] [Rank 0] step=384, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-24 00:16:03,787] [INFO] [timer.py:198:stop] 0/768, RunningAvgSamplesPerSec=5.773684862592275, CurrSamplesPerSec=3.448816456750051, MemAllocated=4.92GB, MaxMemAllocated=19.59GB
[2022-11-24 00:16:19,884] [INFO] [timer.py:198:stop] 0/770, RunningAvgSamplesPerSec=5.76501213364654, CurrSamplesPerSec=3.457976348298674, MemAllocated=4.92GB, MaxMemAllocated=19.59GB
***** Evaluating perplexity, Epoch 2/2 *****
'step':770, 'ppl': 21.503453453504573, 'seq_len': 984, 'consume layer-tokens': 22026496
[2022-11-24 00:16:43,485] [INFO] [logging.py:68:log_dist] [Rank 0] step=386, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-24 00:16:43,486] [INFO] [timer.py:198:stop] 0/772, RunningAvgSamplesPerSec=5.756378265138318, CurrSamplesPerSec=3.452629187419149, MemAllocated=4.92GB, MaxMemAllocated=19.59GB
[2022-11-24 00:16:59,588] [INFO] [timer.py:198:stop] 0/774, RunningAvgSamplesPerSec=5.747751077323672, CurrSamplesPerSec=3.439926416826697, MemAllocated=4.92GB, MaxMemAllocated=19.73GB
[2022-11-24 00:17:15,686] [INFO] [logging.py:68:log_dist] [Rank 0] step=388, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-24 00:17:15,687] [INFO] [timer.py:198:stop] 0/776, RunningAvgSamplesPerSec=5.739182214478375, CurrSamplesPerSec=3.4417089463997197, MemAllocated=4.92GB, MaxMemAllocated=19.73GB
[2022-11-24 00:17:31,787] [INFO] [timer.py:198:stop] 0/778, RunningAvgSamplesPerSec=5.730731792636909, CurrSamplesPerSec=3.448033945135513, MemAllocated=4.92GB, MaxMemAllocated=19.73GB
[2022-11-24 00:17:47,885] [INFO] [logging.py:68:log_dist] [Rank 0] step=390, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-24 00:17:47,886] [INFO] [timer.py:198:stop] 0/780, RunningAvgSamplesPerSec=5.722352174304725, CurrSamplesPerSec=3.447886555162392, MemAllocated=4.92GB, MaxMemAllocated=19.73GB
***** Evaluating perplexity, Epoch 2/2 *****
'step':780, 'ppl': 21.29520733269086, 'seq_len': 1000, 'consume layer-tokens': 22504640
[2022-11-24 00:18:11,503] [INFO] [timer.py:198:stop] 0/782, RunningAvgSamplesPerSec=5.713841673916204, CurrSamplesPerSec=3.4190707388211665, MemAllocated=4.93GB, MaxMemAllocated=19.87GB
[2022-11-24 00:18:27,607] [INFO] [logging.py:68:log_dist] [Rank 0] step=392, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-24 00:18:27,608] [INFO] [timer.py:198:stop] 0/784, RunningAvgSamplesPerSec=5.705429051097843, CurrSamplesPerSec=3.4242444899906888, MemAllocated=4.92GB, MaxMemAllocated=19.87GB
[2022-11-24 00:18:43,715] [INFO] [timer.py:198:stop] 0/786, RunningAvgSamplesPerSec=5.6970670285595, CurrSamplesPerSec=3.4180356357765955, MemAllocated=4.92GB, MaxMemAllocated=19.87GB
[2022-11-24 00:18:59,823] [INFO] [logging.py:68:log_dist] [Rank 0] step=394, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-24 00:18:59,824] [INFO] [timer.py:198:stop] 0/788, RunningAvgSamplesPerSec=5.688724456383303, CurrSamplesPerSec=3.417690276544765, MemAllocated=4.93GB, MaxMemAllocated=20.01GB
[2022-11-24 00:19:15,948] [INFO] [timer.py:198:stop] 0/790, RunningAvgSamplesPerSec=5.680405126706944, CurrSamplesPerSec=3.4074504344915577, MemAllocated=4.93GB, MaxMemAllocated=20.01GB
***** Evaluating perplexity, Epoch 2/2 *****
'step':790, 'ppl': 21.078514378859214, 'seq_len': 1008, 'consume layer-tokens': 22987712
[2022-11-24 00:19:39,569] [INFO] [logging.py:68:log_dist] [Rank 0] step=396, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-24 00:19:39,570] [INFO] [timer.py:198:stop] 0/792, RunningAvgSamplesPerSec=5.672181624085635, CurrSamplesPerSec=3.4139570583981205, MemAllocated=4.93GB, MaxMemAllocated=20.01GB
[2022-11-24 00:19:55,679] [INFO] [timer.py:198:stop] 0/794, RunningAvgSamplesPerSec=5.664009227849562, CurrSamplesPerSec=3.407509952067593, MemAllocated=4.93GB, MaxMemAllocated=20.01GB
[2022-11-24 00:20:11,785] [INFO] [logging.py:68:log_dist] [Rank 0] step=398, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-24 00:20:11,786] [INFO] [timer.py:198:stop] 0/796, RunningAvgSamplesPerSec=5.655817350724672, CurrSamplesPerSec=3.3969017059406648, MemAllocated=4.93GB, MaxMemAllocated=20.15GB
[2022-11-24 00:20:27,908] [INFO] [timer.py:198:stop] 0/798, RunningAvgSamplesPerSec=5.64761641246157, CurrSamplesPerSec=3.3825905184649927, MemAllocated=4.93GB, MaxMemAllocated=20.15GB
[2022-11-24 00:20:44,018] [INFO] [logging.py:68:log_dist] [Rank 0] step=400, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-24 00:20:44,018] [INFO] [timer.py:198:stop] 0/800, RunningAvgSamplesPerSec=5.639548633660666, CurrSamplesPerSec=3.395518467156771, MemAllocated=4.93GB, MaxMemAllocated=20.15GB
***** Evaluating perplexity, Epoch 2/2 *****
'step':800, 'ppl': 20.877532774343106, 'seq_len': 1024, 'consume layer-tokens': 23475712
[2022-11-24 00:21:07,630] [INFO] [timer.py:198:stop] 0/802, RunningAvgSamplesPerSec=5.631592100560015, CurrSamplesPerSec=3.4049760678542897, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:21:23,756] [INFO] [logging.py:68:log_dist] [Rank 0] step=402, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-24 00:21:23,757] [INFO] [timer.py:198:stop] 0/804, RunningAvgSamplesPerSec=5.623494060631755, CurrSamplesPerSec=3.346518703920385, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:21:39,897] [INFO] [timer.py:198:stop] 0/806, RunningAvgSamplesPerSec=5.615687985032192, CurrSamplesPerSec=3.4082437115797943, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:21:56,017] [INFO] [logging.py:68:log_dist] [Rank 0] step=404, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-24 00:21:56,017] [INFO] [timer.py:198:stop] 0/808, RunningAvgSamplesPerSec=5.607898128308614, CurrSamplesPerSec=3.40194782679225, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:22:12,133] [INFO] [timer.py:198:stop] 0/810, RunningAvgSamplesPerSec=5.600184595036319, CurrSamplesPerSec=3.4027095579272557, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
***** Evaluating perplexity, Epoch 2/2 *****
'step':810, 'ppl': 20.707577748412625, 'seq_len': 1024, 'consume layer-tokens': 23967232
[2022-11-24 00:22:35,751] [INFO] [logging.py:68:log_dist] [Rank 0] step=406, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-24 00:22:35,751] [INFO] [timer.py:198:stop] 0/812, RunningAvgSamplesPerSec=5.592503388559413, CurrSamplesPerSec=3.39727727233149, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:22:51,864] [INFO] [timer.py:198:stop] 0/814, RunningAvgSamplesPerSec=5.584918630690597, CurrSamplesPerSec=3.404601561019245, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:23:07,969] [INFO] [logging.py:68:log_dist] [Rank 0] step=408, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-24 00:23:07,970] [INFO] [timer.py:198:stop] 0/816, RunningAvgSamplesPerSec=5.5773900674228765, CurrSamplesPerSec=3.401998874193564, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:23:24,074] [INFO] [timer.py:198:stop] 0/818, RunningAvgSamplesPerSec=5.569907811299068, CurrSamplesPerSec=3.4018664300510486, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:23:40,180] [INFO] [logging.py:68:log_dist] [Rank 0] step=410, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-24 00:23:40,181] [INFO] [timer.py:198:stop] 0/820, RunningAvgSamplesPerSec=5.5624693112483286, CurrSamplesPerSec=3.401996114835408, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
***** Evaluating perplexity, Epoch 2/2 *****
'step':820, 'ppl': 20.51902854085314, 'seq_len': 1024, 'consume layer-tokens': 24458752
[2022-11-24 00:24:03,797] [INFO] [timer.py:198:stop] 0/822, RunningAvgSamplesPerSec=5.555089251618555, CurrSamplesPerSec=3.4009754594511317, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:24:19,904] [INFO] [logging.py:68:log_dist] [Rank 0] step=412, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-24 00:24:19,905] [INFO] [timer.py:198:stop] 0/824, RunningAvgSamplesPerSec=5.547789782927828, CurrSamplesPerSec=3.4036124853374905, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:24:36,019] [INFO] [timer.py:198:stop] 0/826, RunningAvgSamplesPerSec=5.540522482231229, CurrSamplesPerSec=3.403798929106458, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:24:52,130] [INFO] [logging.py:68:log_dist] [Rank 0] step=414, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-24 00:24:52,130] [INFO] [timer.py:198:stop] 0/828, RunningAvgSamplesPerSec=5.5333129717137, CurrSamplesPerSec=3.4028779575774464, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:25:08,246] [INFO] [timer.py:198:stop] 0/830, RunningAvgSamplesPerSec=5.52614469162689, CurrSamplesPerSec=3.400177292531461, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
***** Evaluating perplexity, Epoch 2/2 *****
'step':830, 'ppl': 20.40009738333861, 'seq_len': 1024, 'consume layer-tokens': 24950272
[2022-11-24 00:25:31,847] [INFO] [logging.py:68:log_dist] [Rank 0] step=416, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-24 00:25:31,848] [INFO] [timer.py:198:stop] 0/832, RunningAvgSamplesPerSec=5.519054645657034, CurrSamplesPerSec=3.407302341639757, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:25:47,961] [INFO] [timer.py:198:stop] 0/834, RunningAvgSamplesPerSec=5.511991498855589, CurrSamplesPerSec=3.402483210887157, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:26:04,064] [INFO] [logging.py:68:log_dist] [Rank 0] step=418, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-24 00:26:04,065] [INFO] [timer.py:198:stop] 0/836, RunningAvgSamplesPerSec=5.50499852886191, CurrSamplesPerSec=3.4092548790102986, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:26:20,179] [INFO] [timer.py:198:stop] 0/838, RunningAvgSamplesPerSec=5.498024051501876, CurrSamplesPerSec=3.3945648813445195, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:26:36,282] [INFO] [logging.py:68:log_dist] [Rank 0] step=420, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-24 00:26:36,282] [INFO] [timer.py:198:stop] 0/840, RunningAvgSamplesPerSec=5.491114166416255, CurrSamplesPerSec=3.4026129427020906, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
***** Evaluating perplexity, Epoch 2/2 *****
'step':840, 'ppl': 20.269239112872366, 'seq_len': 1024, 'consume layer-tokens': 25441792
[2022-11-24 00:26:59,879] [INFO] [timer.py:198:stop] 0/842, RunningAvgSamplesPerSec=5.484266257873932, CurrSamplesPerSec=3.4043114094199414, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:27:16,001] [INFO] [logging.py:68:log_dist] [Rank 0] step=422, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-24 00:27:16,001] [INFO] [timer.py:198:stop] 0/844, RunningAvgSamplesPerSec=5.477466973029134, CurrSamplesPerSec=3.4026101823477037, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:27:32,132] [INFO] [timer.py:198:stop] 0/846, RunningAvgSamplesPerSec=5.470727748871249, CurrSamplesPerSec=3.4061318923694857, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:27:48,240] [INFO] [logging.py:68:log_dist] [Rank 0] step=424, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-24 00:27:48,241] [INFO] [timer.py:198:stop] 0/848, RunningAvgSamplesPerSec=5.464058003793266, CurrSamplesPerSec=3.4069466945711713, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:28:04,354] [INFO] [timer.py:198:stop] 0/850, RunningAvgSamplesPerSec=5.45741810443804, CurrSamplesPerSec=3.4070075782959943, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
***** Evaluating perplexity, Epoch 2/2 *****
'step':850, 'ppl': 20.149725262104457, 'seq_len': 1024, 'consume layer-tokens': 25933312
[2022-11-24 00:28:27,980] [INFO] [logging.py:68:log_dist] [Rank 0] step=426, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-24 00:28:27,981] [INFO] [timer.py:198:stop] 0/852, RunningAvgSamplesPerSec=5.450796683662783, CurrSamplesPerSec=3.3984485270405824, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:28:44,090] [INFO] [timer.py:198:stop] 0/854, RunningAvgSamplesPerSec=5.444244956706005, CurrSamplesPerSec=3.405961787618675, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:29:00,240] [INFO] [logging.py:68:log_dist] [Rank 0] step=428, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-24 00:29:00,240] [INFO] [timer.py:198:stop] 0/856, RunningAvgSamplesPerSec=5.437727613486345, CurrSamplesPerSec=3.4002089914984723, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:29:16,356] [INFO] [timer.py:198:stop] 0/858, RunningAvgSamplesPerSec=5.431256373950202, CurrSamplesPerSec=3.402786854057878, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:29:32,478] [INFO] [logging.py:68:log_dist] [Rank 0] step=430, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-24 00:29:32,478] [INFO] [timer.py:198:stop] 0/860, RunningAvgSamplesPerSec=5.424831262922618, CurrSamplesPerSec=3.3996081899168478, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
***** Evaluating perplexity, Epoch 2/2 *****
'step':860, 'ppl': 20.024016684454626, 'seq_len': 1024, 'consume layer-tokens': 26424832
[2022-11-24 00:29:56,079] [INFO] [timer.py:198:stop] 0/862, RunningAvgSamplesPerSec=5.418445493898537, CurrSamplesPerSec=3.3980974787927987, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:30:12,193] [INFO] [logging.py:68:log_dist] [Rank 0] step=432, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-24 00:30:12,194] [INFO] [timer.py:198:stop] 0/864, RunningAvgSamplesPerSec=5.412115874523676, CurrSamplesPerSec=3.4028655340829803, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:30:28,304] [INFO] [timer.py:198:stop] 0/866, RunningAvgSamplesPerSec=5.405835477062272, CurrSamplesPerSec=3.4051419274596593, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:30:44,423] [INFO] [logging.py:68:log_dist] [Rank 0] step=434, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-24 00:30:44,424] [INFO] [timer.py:198:stop] 0/868, RunningAvgSamplesPerSec=5.399573928555213, CurrSamplesPerSec=3.3987748604508603, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:31:00,537] [INFO] [timer.py:198:stop] 0/870, RunningAvgSamplesPerSec=5.393325238620462, CurrSamplesPerSec=3.386720238748894, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
***** Evaluating perplexity, Epoch 2/2 *****
'step':870, 'ppl': 19.86032970825093, 'seq_len': 1024, 'consume layer-tokens': 26916352
[2022-11-24 00:31:24,172] [INFO] [logging.py:68:log_dist] [Rank 0] step=436, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-24 00:31:24,173] [INFO] [timer.py:198:stop] 0/872, RunningAvgSamplesPerSec=5.387163522102323, CurrSamplesPerSec=3.4001235434598978, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:31:40,286] [INFO] [timer.py:198:stop] 0/874, RunningAvgSamplesPerSec=5.381036306021821, CurrSamplesPerSec=3.4016539891112787, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:31:56,394] [INFO] [logging.py:68:log_dist] [Rank 0] step=438, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-24 00:31:56,395] [INFO] [timer.py:198:stop] 0/876, RunningAvgSamplesPerSec=5.3749714374772815, CurrSamplesPerSec=3.4073092615797673, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:32:12,518] [INFO] [timer.py:198:stop] 0/878, RunningAvgSamplesPerSec=5.368944518062771, CurrSamplesPerSec=3.403749208770876, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:32:28,625] [INFO] [logging.py:68:log_dist] [Rank 0] step=440, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-24 00:32:28,626] [INFO] [timer.py:198:stop] 0/880, RunningAvgSamplesPerSec=5.362957320664741, CurrSamplesPerSec=3.4057806378270845, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
***** Evaluating perplexity, Epoch 2/2 *****
'step':880, 'ppl': 19.754888518269485, 'seq_len': 1024, 'consume layer-tokens': 27407872
[2022-11-24 00:32:52,217] [INFO] [timer.py:198:stop] 0/882, RunningAvgSamplesPerSec=5.3570185160245405, CurrSamplesPerSec=3.4035834848091406, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:33:08,327] [INFO] [logging.py:68:log_dist] [Rank 0] step=442, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-24 00:33:08,328] [INFO] [timer.py:198:stop] 0/884, RunningAvgSamplesPerSec=5.351110591339036, CurrSamplesPerSec=3.402074758297026, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:33:24,442] [INFO] [timer.py:198:stop] 0/886, RunningAvgSamplesPerSec=5.345235982018653, CurrSamplesPerSec=3.4040903747271507, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:33:40,556] [INFO] [logging.py:68:log_dist] [Rank 0] step=444, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-24 00:33:40,557] [INFO] [timer.py:198:stop] 0/888, RunningAvgSamplesPerSec=5.339412057718243, CurrSamplesPerSec=3.4051695722981847, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:33:56,674] [INFO] [timer.py:198:stop] 0/890, RunningAvgSamplesPerSec=5.333639805927381, CurrSamplesPerSec=3.4075680875211942, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
***** Evaluating perplexity, Epoch 2/2 *****
'step':890, 'ppl': 19.65317740785385, 'seq_len': 1024, 'consume layer-tokens': 27899392
[2022-11-24 00:34:20,290] [INFO] [logging.py:68:log_dist] [Rank 0] step=446, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-24 00:34:20,291] [INFO] [timer.py:198:stop] 0/892, RunningAvgSamplesPerSec=5.327879317934553, CurrSamplesPerSec=3.4014070943473342, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:34:36,395] [INFO] [timer.py:198:stop] 0/894, RunningAvgSamplesPerSec=5.322168371899259, CurrSamplesPerSec=3.402145126581611, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:34:52,511] [INFO] [logging.py:68:log_dist] [Rank 0] step=448, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-24 00:34:52,512] [INFO] [timer.py:198:stop] 0/896, RunningAvgSamplesPerSec=5.316514777811084, CurrSamplesPerSec=3.4079349402984285, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:35:08,621] [INFO] [timer.py:198:stop] 0/898, RunningAvgSamplesPerSec=5.310864199991366, CurrSamplesPerSec=3.403739541096527, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:35:24,737] [INFO] [logging.py:68:log_dist] [Rank 0] step=450, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-24 00:35:24,737] [INFO] [timer.py:198:stop] 0/900, RunningAvgSamplesPerSec=5.3052547380716, CurrSamplesPerSec=3.4023617687916365, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
***** Evaluating perplexity, Epoch 2/2 *****
'step':900, 'ppl': 19.595742510662994, 'seq_len': 1024, 'consume layer-tokens': 28390912
[2022-11-24 00:35:48,346] [INFO] [timer.py:198:stop] 0/902, RunningAvgSamplesPerSec=5.299677746831998, CurrSamplesPerSec=3.404482731051153, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:36:04,446] [INFO] [logging.py:68:log_dist] [Rank 0] step=452, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-24 00:36:04,447] [INFO] [timer.py:198:stop] 0/904, RunningAvgSamplesPerSec=5.294155536117524, CurrSamplesPerSec=3.4029110873395165, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:36:20,563] [INFO] [timer.py:198:stop] 0/906, RunningAvgSamplesPerSec=5.288652054977276, CurrSamplesPerSec=3.4014622632519886, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:36:36,687] [INFO] [logging.py:68:log_dist] [Rank 0] step=454, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-24 00:36:36,687] [INFO] [timer.py:198:stop] 0/908, RunningAvgSamplesPerSec=5.283193536570267, CurrSamplesPerSec=3.4091565062498703, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:36:52,798] [INFO] [timer.py:198:stop] 0/910, RunningAvgSamplesPerSec=5.277770612044629, CurrSamplesPerSec=3.4012664217402535, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
***** Evaluating perplexity, Epoch 2/2 *****
'step':910, 'ppl': 19.482170589551277, 'seq_len': 1024, 'consume layer-tokens': 28882432
[2022-11-24 00:37:16,427] [INFO] [logging.py:68:log_dist] [Rank 0] step=456, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-24 00:37:16,428] [INFO] [timer.py:198:stop] 0/912, RunningAvgSamplesPerSec=5.272401650652077, CurrSamplesPerSec=3.4050507026771633, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:37:32,544] [INFO] [timer.py:198:stop] 0/914, RunningAvgSamplesPerSec=5.267041633058806, CurrSamplesPerSec=3.4007300418209208, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:37:48,670] [INFO] [logging.py:68:log_dist] [Rank 0] step=458, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-24 00:37:48,671] [INFO] [timer.py:198:stop] 0/916, RunningAvgSamplesPerSec=5.261733434219438, CurrSamplesPerSec=3.408279715460962, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:38:04,777] [INFO] [timer.py:198:stop] 0/918, RunningAvgSamplesPerSec=5.256436290373581, CurrSamplesPerSec=3.402428008859949, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:38:20,900] [INFO] [logging.py:68:log_dist] [Rank 0] step=460, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-24 00:38:20,900] [INFO] [timer.py:198:stop] 0/920, RunningAvgSamplesPerSec=5.2511960490437275, CurrSamplesPerSec=3.405599507303767, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
***** Evaluating perplexity, Epoch 2/2 *****
'step':920, 'ppl': 19.4236603045395, 'seq_len': 1024, 'consume layer-tokens': 29373952
[2022-11-24 00:38:44,509] [INFO] [timer.py:198:stop] 0/922, RunningAvgSamplesPerSec=5.24599897091126, CurrSamplesPerSec=3.4071072109032525, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:39:00,620] [INFO] [logging.py:68:log_dist] [Rank 0] step=462, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-24 00:39:00,620] [INFO] [timer.py:198:stop] 0/924, RunningAvgSamplesPerSec=5.240819351183567, CurrSamplesPerSec=3.406041997498032, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:39:16,734] [INFO] [timer.py:198:stop] 0/926, RunningAvgSamplesPerSec=5.2356730309103545, CurrSamplesPerSec=3.403869368735121, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:39:32,854] [INFO] [logging.py:68:log_dist] [Rank 0] step=464, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-24 00:39:32,854] [INFO] [timer.py:198:stop] 0/928, RunningAvgSamplesPerSec=5.230541591558955, CurrSamplesPerSec=3.4017367551535336, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:39:48,973] [INFO] [timer.py:198:stop] 0/930, RunningAvgSamplesPerSec=5.225436333561799, CurrSamplesPerSec=3.403276938019248, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
***** Evaluating perplexity, Epoch 2/2 *****
'step':930, 'ppl': 19.334869578592592, 'seq_len': 1024, 'consume layer-tokens': 29865472
[2022-11-24 00:40:12,573] [INFO] [logging.py:68:log_dist] [Rank 0] step=466, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-24 00:40:12,573] [INFO] [timer.py:198:stop] 0/932, RunningAvgSamplesPerSec=5.220374310293221, CurrSamplesPerSec=3.403941192534758, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:40:28,690] [INFO] [timer.py:198:stop] 0/934, RunningAvgSamplesPerSec=5.215339336024205, CurrSamplesPerSec=3.4036083423746115, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:40:44,817] [INFO] [logging.py:68:log_dist] [Rank 0] step=468, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-24 00:40:44,818] [INFO] [timer.py:198:stop] 0/936, RunningAvgSamplesPerSec=5.210352602692519, CurrSamplesPerSec=3.398973169588283, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:41:00,929] [INFO] [timer.py:198:stop] 0/938, RunningAvgSamplesPerSec=5.205385185761985, CurrSamplesPerSec=3.4036083423746115, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:41:17,060] [INFO] [logging.py:68:log_dist] [Rank 0] step=470, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-24 00:41:17,061] [INFO] [timer.py:198:stop] 0/940, RunningAvgSamplesPerSec=5.200424490544366, CurrSamplesPerSec=3.3988203042509726, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
***** Evaluating perplexity, Epoch 2/2 *****
'step':940, 'ppl': 19.23135425149785, 'seq_len': 1024, 'consume layer-tokens': 30356992
[2022-11-24 00:41:40,689] [INFO] [timer.py:198:stop] 0/942, RunningAvgSamplesPerSec=5.195520796710439, CurrSamplesPerSec=3.40139192321229, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:41:56,816] [INFO] [logging.py:68:log_dist] [Rank 0] step=472, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-24 00:41:56,817] [INFO] [timer.py:198:stop] 0/944, RunningAvgSamplesPerSec=5.190627169906491, CurrSamplesPerSec=3.399037900496609, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:42:12,946] [INFO] [timer.py:198:stop] 0/946, RunningAvgSamplesPerSec=5.185789324646521, CurrSamplesPerSec=3.4029759683255714, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:42:29,062] [INFO] [logging.py:68:log_dist] [Rank 0] step=474, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-24 00:42:29,062] [INFO] [timer.py:198:stop] 0/948, RunningAvgSamplesPerSec=5.180965703869282, CurrSamplesPerSec=3.398302592294012, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:42:45,181] [INFO] [timer.py:198:stop] 0/950, RunningAvgSamplesPerSec=5.17620301792617, CurrSamplesPerSec=3.4097426700723683, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
***** Evaluating perplexity, Epoch 2/2 *****
'step':950, 'ppl': 19.254143414698937, 'seq_len': 1024, 'consume layer-tokens': 30848512
[2022-11-24 00:43:08,798] [INFO] [logging.py:68:log_dist] [Rank 0] step=476, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-24 00:43:08,799] [INFO] [timer.py:198:stop] 0/952, RunningAvgSamplesPerSec=5.171451090782393, CurrSamplesPerSec=3.4000794429267422, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:43:24,909] [INFO] [timer.py:198:stop] 0/954, RunningAvgSamplesPerSec=5.166728336613156, CurrSamplesPerSec=3.4015519165390704, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:43:41,037] [INFO] [logging.py:68:log_dist] [Rank 0] step=478, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-24 00:43:41,038] [INFO] [timer.py:198:stop] 0/956, RunningAvgSamplesPerSec=5.162016314397375, CurrSamplesPerSec=3.3966431224176774, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:43:57,161] [INFO] [timer.py:198:stop] 0/958, RunningAvgSamplesPerSec=5.1573647956399435, CurrSamplesPerSec=3.405658960236901, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:44:13,289] [INFO] [logging.py:68:log_dist] [Rank 0] step=480, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-24 00:44:13,290] [INFO] [timer.py:198:stop] 0/960, RunningAvgSamplesPerSec=5.152708571510042, CurrSamplesPerSec=3.3974877909100702, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
***** Evaluating perplexity, Epoch 2/2 *****
'step':960, 'ppl': 19.132537173636155, 'seq_len': 1024, 'consume layer-tokens': 31340032
[2022-11-24 00:44:36,913] [INFO] [timer.py:198:stop] 0/962, RunningAvgSamplesPerSec=5.148092818976806, CurrSamplesPerSec=3.4048281899990216, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:44:53,051] [INFO] [logging.py:68:log_dist] [Rank 0] step=482, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-24 00:44:53,052] [INFO] [timer.py:198:stop] 0/964, RunningAvgSamplesPerSec=5.143493759138948, CurrSamplesPerSec=3.400719012646774, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:45:09,178] [INFO] [timer.py:198:stop] 0/966, RunningAvgSamplesPerSec=5.138902804398203, CurrSamplesPerSec=3.393289233478836, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:45:25,305] [INFO] [logging.py:68:log_dist] [Rank 0] step=484, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-24 00:45:25,306] [INFO] [timer.py:198:stop] 0/968, RunningAvgSamplesPerSec=5.1343484639389, CurrSamplesPerSec=3.396881072831254, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:45:41,409] [INFO] [timer.py:198:stop] 0/970, RunningAvgSamplesPerSec=5.12982000904766, CurrSamplesPerSec=3.398985564677748, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
***** Evaluating perplexity, Epoch 2/2 *****
'step':970, 'ppl': 19.044243292058248, 'seq_len': 1024, 'consume layer-tokens': 31831552
[2022-11-24 00:46:05,039] [INFO] [logging.py:68:log_dist] [Rank 0] step=486, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-24 00:46:05,039] [INFO] [timer.py:198:stop] 0/972, RunningAvgSamplesPerSec=5.125330853896655, CurrSamplesPerSec=3.398940116458341, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:46:21,158] [INFO] [timer.py:198:stop] 0/974, RunningAvgSamplesPerSec=5.120884309087101, CurrSamplesPerSec=3.4045338545556083, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:46:37,286] [INFO] [logging.py:68:log_dist] [Rank 0] step=488, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-24 00:46:37,287] [INFO] [timer.py:198:stop] 0/976, RunningAvgSamplesPerSec=5.116443341225591, CurrSamplesPerSec=3.4002213956029745, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:46:53,419] [INFO] [timer.py:198:stop] 0/978, RunningAvgSamplesPerSec=5.112020140979262, CurrSamplesPerSec=3.4014622632519886, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:47:09,539] [INFO] [logging.py:68:log_dist] [Rank 0] step=490, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-24 00:47:09,540] [INFO] [timer.py:198:stop] 0/980, RunningAvgSamplesPerSec=5.107637619024997, CurrSamplesPerSec=3.3994800647588868, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
***** Evaluating perplexity, Epoch 2/2 *****
'step':980, 'ppl': 18.94877910748458, 'seq_len': 1024, 'consume layer-tokens': 32323072
[2022-11-24 00:47:33,160] [INFO] [timer.py:198:stop] 0/982, RunningAvgSamplesPerSec=5.103267236394936, CurrSamplesPerSec=3.3996991233075686, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:47:49,289] [INFO] [logging.py:68:log_dist] [Rank 0] step=492, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-24 00:47:49,290] [INFO] [timer.py:198:stop] 0/984, RunningAvgSamplesPerSec=5.098921846147965, CurrSamplesPerSec=3.399750103245537, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:48:05,414] [INFO] [timer.py:198:stop] 0/986, RunningAvgSamplesPerSec=5.094602003468919, CurrSamplesPerSec=3.4005701257973815, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:48:21,533] [INFO] [logging.py:68:log_dist] [Rank 0] step=494, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-24 00:48:21,534] [INFO] [timer.py:198:stop] 0/988, RunningAvgSamplesPerSec=5.090337332630463, CurrSamplesPerSec=3.4049677752981564, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:48:37,667] [INFO] [timer.py:198:stop] 0/990, RunningAvgSamplesPerSec=5.086080597719001, CurrSamplesPerSec=3.402123049943667, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
***** Evaluating perplexity, Epoch 2/2 *****
'step':990, 'ppl': 18.874490490087165, 'seq_len': 1024, 'consume layer-tokens': 32814592
[2022-11-24 00:49:01,301] [INFO] [logging.py:68:log_dist] [Rank 0] step=496, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-24 00:49:01,301] [INFO] [timer.py:198:stop] 0/992, RunningAvgSamplesPerSec=5.081837045997524, CurrSamplesPerSec=3.4017298578295145, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:49:17,425] [INFO] [timer.py:198:stop] 0/994, RunningAvgSamplesPerSec=5.077630189035942, CurrSamplesPerSec=3.4004874165141126, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:49:33,557] [INFO] [logging.py:68:log_dist] [Rank 0] step=498, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-24 00:49:33,557] [INFO] [timer.py:198:stop] 0/996, RunningAvgSamplesPerSec=5.073421970512898, CurrSamplesPerSec=3.397009002150311, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:49:49,687] [INFO] [timer.py:198:stop] 0/998, RunningAvgSamplesPerSec=5.06925249089093, CurrSamplesPerSec=3.3980038781749164, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:50:05,804] [INFO] [logging.py:68:log_dist] [Rank 0] step=500, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-24 00:50:05,804] [INFO] [timer.py:198:stop] 0/1000, RunningAvgSamplesPerSec=5.065104380882262, CurrSamplesPerSec=3.398660567779889, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
***** Evaluating perplexity, Epoch 2/2 *****
'step':1000, 'ppl': 18.828466609419998, 'seq_len': 1024, 'consume layer-tokens': 33306112
[2022-11-24 00:50:29,426] [INFO] [timer.py:198:stop] 0/1002, RunningAvgSamplesPerSec=5.060981575263951, CurrSamplesPerSec=3.3999526602660755, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:50:45,551] [INFO] [logging.py:68:log_dist] [Rank 0] step=502, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-24 00:50:45,552] [INFO] [timer.py:198:stop] 0/1004, RunningAvgSamplesPerSec=5.056881139530023, CurrSamplesPerSec=3.4030836486136726, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:51:01,678] [INFO] [timer.py:198:stop] 0/1006, RunningAvgSamplesPerSec=5.052798455940648, CurrSamplesPerSec=3.402045783967095, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:51:17,828] [INFO] [logging.py:68:log_dist] [Rank 0] step=504, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-24 00:51:17,829] [INFO] [timer.py:198:stop] 0/1008, RunningAvgSamplesPerSec=5.048751571840492, CurrSamplesPerSec=3.401229186821314, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:51:33,949] [INFO] [timer.py:198:stop] 0/1010, RunningAvgSamplesPerSec=5.044708757189217, CurrSamplesPerSec=3.39796533824277, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
***** Evaluating perplexity, Epoch 2/2 *****
'step':1010, 'ppl': 18.811226270602248, 'seq_len': 1024, 'consume layer-tokens': 33797632
[2022-11-24 00:51:57,579] [INFO] [logging.py:68:log_dist] [Rank 0] step=506, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-24 00:51:57,580] [INFO] [timer.py:198:stop] 0/1012, RunningAvgSamplesPerSec=5.040703091620797, CurrSamplesPerSec=3.3975827391977216, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:52:13,702] [INFO] [timer.py:198:stop] 0/1014, RunningAvgSamplesPerSec=5.036695384109052, CurrSamplesPerSec=3.3966499991294388, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:52:29,854] [INFO] [logging.py:68:log_dist] [Rank 0] step=508, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-24 00:52:29,854] [INFO] [timer.py:198:stop] 0/1016, RunningAvgSamplesPerSec=5.032676395134385, CurrSamplesPerSec=3.387614699276085, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:52:46,030] [INFO] [timer.py:198:stop] 0/1018, RunningAvgSamplesPerSec=5.028677196590997, CurrSamplesPerSec=3.3851075746985986, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:53:02,214] [INFO] [logging.py:68:log_dist] [Rank 0] step=510, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-24 00:53:02,215] [INFO] [timer.py:198:stop] 0/1020, RunningAvgSamplesPerSec=5.024680323226778, CurrSamplesPerSec=3.3774397898634225, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
***** Evaluating perplexity, Epoch 2/2 *****
'step':1020, 'ppl': 18.717457572150572, 'seq_len': 1024, 'consume layer-tokens': 34289152
[2022-11-24 00:53:25,984] [INFO] [timer.py:198:stop] 0/1022, RunningAvgSamplesPerSec=5.020674993811439, CurrSamplesPerSec=3.3736826780305043, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:53:42,211] [INFO] [logging.py:68:log_dist] [Rank 0] step=512, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-24 00:53:42,211] [INFO] [timer.py:198:stop] 0/1024, RunningAvgSamplesPerSec=5.016629893624728, CurrSamplesPerSec=3.3480801022391558, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:53:58,455] [INFO] [timer.py:198:stop] 0/1026, RunningAvgSamplesPerSec=5.012666244481801, CurrSamplesPerSec=3.373761374760399, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:54:14,696] [INFO] [logging.py:68:log_dist] [Rank 0] step=514, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-24 00:54:14,696] [INFO] [timer.py:198:stop] 0/1028, RunningAvgSamplesPerSec=5.008711800339347, CurrSamplesPerSec=3.3701722005854386, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:54:30,953] [INFO] [timer.py:198:stop] 0/1030, RunningAvgSamplesPerSec=5.004771560560401, CurrSamplesPerSec=3.3717842150196713, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
***** Evaluating perplexity, Epoch 2/2 *****
'step':1030, 'ppl': 18.612610950304106, 'seq_len': 1024, 'consume layer-tokens': 34780672
[2022-11-24 00:54:54,777] [INFO] [logging.py:68:log_dist] [Rank 0] step=516, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-24 00:54:54,778] [INFO] [timer.py:198:stop] 0/1032, RunningAvgSamplesPerSec=5.000845846173429, CurrSamplesPerSec=3.3708994481496557, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:55:11,041] [INFO] [timer.py:198:stop] 0/1034, RunningAvgSamplesPerSec=4.996947860288951, CurrSamplesPerSec=3.3726246992679507, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:55:27,310] [INFO] [logging.py:68:log_dist] [Rank 0] step=518, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-24 00:55:27,311] [INFO] [timer.py:198:stop] 0/1036, RunningAvgSamplesPerSec=4.993061525541825, CurrSamplesPerSec=3.3693978983357473, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:55:43,584] [INFO] [timer.py:198:stop] 0/1038, RunningAvgSamplesPerSec=4.989200904568649, CurrSamplesPerSec=3.3659381952929235, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:55:59,854] [INFO] [logging.py:68:log_dist] [Rank 0] step=520, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-24 00:55:59,857] [INFO] [timer.py:198:stop] 0/1040, RunningAvgSamplesPerSec=4.985301824907431, CurrSamplesPerSec=3.3437107875885093, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
***** Evaluating perplexity, Epoch 2/2 *****
'step':1040, 'ppl': 18.589298724108165, 'seq_len': 1024, 'consume layer-tokens': 35272192
[2022-11-24 00:56:23,707] [INFO] [timer.py:198:stop] 0/1042, RunningAvgSamplesPerSec=4.981477065813348, CurrSamplesPerSec=3.367743546529344, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:56:39,971] [INFO] [logging.py:68:log_dist] [Rank 0] step=522, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-24 00:56:39,971] [INFO] [timer.py:198:stop] 0/1044, RunningAvgSamplesPerSec=4.977693889485314, CurrSamplesPerSec=3.369698371992879, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:56:56,242] [INFO] [timer.py:198:stop] 0/1046, RunningAvgSamplesPerSec=4.973921854652846, CurrSamplesPerSec=3.373681321222529, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
[2022-11-24 00:57:12,515] [INFO] [logging.py:68:log_dist] [Rank 0] step=524, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2022-11-24 00:57:12,516] [INFO] [timer.py:198:stop] 0/1048, RunningAvgSamplesPerSec=4.970175802494282, CurrSamplesPerSec=3.373023397950116, MemAllocated=4.94GB, MaxMemAllocated=20.15GB
***** Evaluating perplexity, Epoch 2/2 *****
'step':1047, 'ppl': 18.569010769928337, 'seq_len': 1024, 'consume layer-tokens': 35567104
***** Evaluating perplexity, Epoch 2/2 *****
Before cleaning, Epoch at 2 with Perplexity: 18.569010769928337
saving model ...
